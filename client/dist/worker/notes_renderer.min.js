self.onmessage=function(t){"use strict";var o,i,a,s,d,p,e,n,h=t.data,r=h.width,l=h.height,f=4*r,g=[],u=0,w=0,y=0,m=0,c=0,A=0,v=0,C=1;for(h.options.float?(o=new Float32Array(h.data),s=1):(o=new Uint8ClampedArray(h.data),s=1/255),o.length,h.options.mono&&(v=3,C=3),h.options.flipY&&(A=-(l-1)),d=0;d<l;d+=1)for(y=0,m=0,p=0;p<r;p+=1)i=y,a=m,y=o[(c=d*f+4*p)+v],m=o[c+C],g[p]||(g[p]=[]),y>0||m>0?(e=y*s,n=m*s,u=i*s,w=a*s,g[p].push({y:d+A,pl:u,pr:w,dl:e-u,dr:n-w})):(i>0||a>0)&&(u=i*s,w=a*s,g[p].push({y:d+A,pl:u,pr:w,dl:-u,dr:-w}));postMessage({uid:h.uid,width:h.width,height:h.height,options:h.options,data:g})};