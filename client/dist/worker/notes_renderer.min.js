self.onmessage=function(t){"use strict";var o,i,a,s,d,p,e,n,h,r=t.data,l=r.width,f=r.height,g=4*l,u=[],w=0,y=0,m=0,c=0,A=0,v=0,C=0,F=1;for(r.options.float?(o=new Float32Array(r.data),s=1):(o=new Uint8ClampedArray(r.data),s=1/255),d=o.length,r.options.mono&&(C=3,F=3),r.options.flipY&&(v=-(f-1)),p=0;p<f;p+=1)for(m=0,c=0,e=0;e<l;e+=1)A=p*g+4*e,i=m,a=c,m=o[A+C],c=o[A+F],u[e]||(u[e]=[]),m>0||c>0?(n=m*s,h=c*s,w=i*s,y=a*s,u[e].push({y:p+v,pl:w,pr:y,dl:n-w,dr:h-y})):(i>0||a>0)&&(w=i*s,y=a*s,u[e].push({y:p+v,pl:w,pr:y,dl:-w,dr:-y}));postMessage({uid:r.uid,width:r.width,height:r.height,options:r.options,data:u})};