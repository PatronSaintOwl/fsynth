function setupTypedArray(t,e){"function"!=typeof this[t]&&"object"!=typeof this[t]&&("function"==typeof this[e]&&"object"!=typeof this[e]?this[t]=this[e]:this[t]=function(t){return t instanceof Array?t:"number"==typeof t?new Array(t):void 0})}function FourierTransform(t,e){this.bufferSize=t,this.sampleRate=e,this.bandwidth=2/t*e/2,this.spectrum=new Float32Array(t/2),this.real=new Float32Array(t),this.imag=new Float32Array(t),this.peakBand=0,this.peak=0,this.getBandFrequency=function(t){return this.bandwidth*t+this.bandwidth/2},this.calculateSpectrum=function(){for(var e,r,a,n=this.spectrum,s=this.real,i=this.imag,o=2/this.bufferSize,h=Math.sqrt,u=0,l=t/2;u<l;u++)e=s[u],r=i[u],a=o*h(e*e+r*r),a>this.peak&&(this.peakBand=u,this.peak=a),n[u]=a}}function DFT(t,e){FourierTransform.call(this,t,e);var r=t/2*t,a=2*Math.PI;this.sinTable=new Float32Array(r),this.cosTable=new Float32Array(r);for(var n=0;n<r;n++)this.sinTable[n]=Math.sin(n*a/t),this.cosTable[n]=Math.cos(n*a/t)}function FFT(t,e){FourierTransform.call(this,t,e),this.reverseTable=new Uint32Array(t);for(var r,a=1,n=t>>1;a<t;){for(r=0;r<a;r++)this.reverseTable[r+a]=this.reverseTable[r]+n;a<<=1,n>>=1}for(this.sinTable=new Float32Array(t),this.cosTable=new Float32Array(t),r=0;r<t;r++)this.sinTable[r]=Math.sin(-Math.PI/r),this.cosTable[r]=Math.cos(-Math.PI/r)}function RFFT(t,e){FourierTransform.call(this,t,e),this.trans=new Float32Array(t),this.reverseTable=new Uint32Array(t),this.reverseBinPermute=function(t,e){var r,a=this.bufferSize,n=a>>>1,s=a-1,i=1,o=0;t[0]=e[0];do{for(o+=n,t[i]=e[o],t[o]=e[i],i++,r=n<<1;r>>=1,!((o^=r)&r););o>=i&&(t[i]=e[o],t[o]=e[i],t[s-i]=e[s-o],t[s-o]=e[s-i]),i++}while(i<n);t[s]=e[s]},this.generateReverseTable=function(){var t,e=this.bufferSize,r=e>>>1,a=e-1,n=1,s=0;this.reverseTable[0]=0;do{for(s+=r,this.reverseTable[n]=s,this.reverseTable[s]=n,n++,t=r<<1;t>>=1,!((s^=t)&t););s>=n&&(this.reverseTable[n]=s,this.reverseTable[s]=n,this.reverseTable[a-n]=a-s,this.reverseTable[a-s]=a-n),n++}while(n<r);this.reverseTable[a]=a},this.generateReverseTable()}function Sampler(t,e,r,a,n,s,i,o){this.file=t,this.bufferSize=e,this.sampleRate=r,this.playStart=a||0,this.playEnd=n||1,this.loopStart=s||0,this.loopEnd=i||1,this.loopMode=o||DSP.OFF,this.loaded=!1,this.samples=[],this.signal=new Float32Array(e),this.frameCount=0,this.envelope=null,this.amplitude=1,this.rootFrequency=110,this.frequency=550,this.step=this.frequency/this.rootFrequency,this.duration=0,this.samplesProcessed=0,this.playhead=0;var h=document.createElement("AUDIO"),u=this;this.loadSamples=function(t){for(var e=DSP.getChannel(DSP.MIX,t.frameBuffer),r=0;r<e.length;r++)u.samples.push(e[r])},this.loadComplete=function(){u.samples=new Float32Array(u.samples),u.loaded=!0},this.loadMetaData=function(){u.duration=h.duration},h.addEventListener("MozAudioAvailable",this.loadSamples,!1),h.addEventListener("loadedmetadata",this.loadMetaData,!1),h.addEventListener("ended",this.loadComplete,!1),h.muted=!0,h.src=t,h.play()}function Oscillator(t,e,r,a,n){switch(this.frequency=e,this.amplitude=r,this.bufferSize=a,this.sampleRate=n,this.frameCount=0,this.waveTableLength=2048,this.cyclesPerSample=e/n,this.signal=new Float32Array(a),this.envelope=null,parseInt(t,10)){case DSP.TRIANGLE:this.func=Oscillator.Triangle;break;case DSP.SAW:this.func=Oscillator.Saw;break;case DSP.SQUARE:this.func=Oscillator.Square;break;default:case DSP.SINE:this.func=Oscillator.Sine}this.generateWaveTable=function(){Oscillator.waveTable[this.func]=new Float32Array(2048);for(var t=this.waveTableLength/this.sampleRate,e=1/t,r=0;r<this.waveTableLength;r++)Oscillator.waveTable[this.func][r]=this.func(r*e/this.sampleRate)},"undefined"==typeof Oscillator.waveTable&&(Oscillator.waveTable={}),"undefined"==typeof Oscillator.waveTable[this.func]&&this.generateWaveTable(),this.waveTable=Oscillator.waveTable[this.func]}function ADSR(t,e,r,a,n,s){this.sampleRate=s,this.attackLength=t,this.decayLength=e,this.sustainLevel=r,this.sustainLength=a,this.releaseLength=n,this.sampleRate=s,this.attackSamples=t*s,this.decaySamples=e*s,this.sustainSamples=a*s,this.releaseSamples=n*s,this.update=function(){this.attack=this.attackSamples,this.decay=this.attack+this.decaySamples,this.sustain=this.decay+this.sustainSamples,this.release=this.sustain+this.releaseSamples},this.update(),this.samplesProcessed=0}function IIRFilter(t,e,r,a){switch(this.sampleRate=a,t){case DSP.LOWPASS:case DSP.LP12:this.func=new IIRFilter.LP12(e,r,a)}}function IIRFilter2(t,e,r,a){this.type=t,this.cutoff=e,this.resonance=r,this.sampleRate=a,this.f=Float32Array(4),this.f[0]=0,this.f[1]=0,this.f[2]=0,this.f[3]=0,this.calcCoeff=function(t,e){this.freq=2*Math.sin(Math.PI*Math.min(.25,t/(2*this.sampleRate))),this.damp=Math.min(2*(1-Math.pow(e,.25)),Math.min(2,2/this.freq-.5*this.freq))},this.calcCoeff(e,r)}function WindowFunction(t,e){switch(this.alpha=e,t){case DSP.BARTLETT:this.func=WindowFunction.Bartlett;break;case DSP.BARTLETTHANN:this.func=WindowFunction.BartlettHann;break;case DSP.BLACKMAN:this.func=WindowFunction.Blackman,this.alpha=this.alpha||.16;break;case DSP.COSINE:this.func=WindowFunction.Cosine;break;case DSP.GAUSS:this.func=WindowFunction.Gauss,this.alpha=this.alpha||.25;break;case DSP.HAMMING:this.func=WindowFunction.Hamming;break;case DSP.HANN:this.func=WindowFunction.Hann;break;case DSP.LANCZOS:this.func=WindowFunction.Lanczoz;break;case DSP.RECTANGULAR:this.func=WindowFunction.Rectangular;break;case DSP.TRIANGULAR:this.func=WindowFunction.Triangular}}function sinh(t){return(Math.exp(t)-Math.exp(-t))/2}function Biquad(t,e){this.Fs=e,this.type=t,this.parameterType=DSP.Q,this.x_1_l=0,this.x_2_l=0,this.y_1_l=0,this.y_2_l=0,this.x_1_r=0,this.x_2_r=0,this.y_1_r=0,this.y_2_r=0,this.b0=1,this.a0=1,this.b1=0,this.a1=0,this.b2=0,this.a2=0,this.b0a0=this.b0/this.a0,this.b1a0=this.b1/this.a0,this.b2a0=this.b2/this.a0,this.a1a0=this.a1/this.a0,this.a2a0=this.a2/this.a0,this.f0=3e3,this.dBgain=12,this.Q=1,this.BW=-3,this.S=1,this.coefficients=function(){var t=[this.b0,this.b1,this.b2],e=[this.a0,this.a1,this.a2];return{b:t,a:e}},this.setFilterType=function(t){this.type=t,this.recalculateCoefficients()},this.setSampleRate=function(t){this.Fs=t,this.recalculateCoefficients()},this.setQ=function(t){this.parameterType=DSP.Q,this.Q=Math.max(Math.min(t,115),.001),this.recalculateCoefficients()},this.setBW=function(t){this.parameterType=DSP.BW,this.BW=t,this.recalculateCoefficients()},this.setS=function(t){this.parameterType=DSP.S,this.S=Math.max(Math.min(t,5),1e-4),this.recalculateCoefficients()},this.setF0=function(t){this.f0=t,this.recalculateCoefficients()},this.setDbGain=function(t){this.dBgain=t,this.recalculateCoefficients()},this.recalculateCoefficients=function(){var e;e=t===DSP.PEAKING_EQ||t===DSP.LOW_SHELF||t===DSP.HIGH_SHELF?Math.pow(10,this.dBgain/40):Math.sqrt(Math.pow(10,this.dBgain/20));var r=DSP.TWO_PI*this.f0/this.Fs,a=Math.cos(r),n=Math.sin(r),s=0;switch(this.parameterType){case DSP.Q:s=n/(2*this.Q);break;case DSP.BW:s=n*sinh(Math.LN2/2*this.BW*r/n);break;case DSP.S:s=n/2*Math.sqrt((e+1/e)*(1/this.S-1)+2)}var i;switch(this.type){case DSP.LPF:this.b0=(1-a)/2,this.b1=1-a,this.b2=(1-a)/2,this.a0=1+s,this.a1=-2*a,this.a2=1-s;break;case DSP.HPF:this.b0=(1+a)/2,this.b1=-(1+a),this.b2=(1+a)/2,this.a0=1+s,this.a1=-2*a,this.a2=1-s;break;case DSP.BPF_CONSTANT_SKIRT:this.b0=n/2,this.b1=0,this.b2=-n/2,this.a0=1+s,this.a1=-2*a,this.a2=1-s;break;case DSP.BPF_CONSTANT_PEAK:this.b0=s,this.b1=0,this.b2=-s,this.a0=1+s,this.a1=-2*a,this.a2=1-s;break;case DSP.NOTCH:this.b0=1,this.b1=-2*a,this.b2=1,this.a0=1+s,this.a1=-2*a,this.a2=1-s;break;case DSP.APF:this.b0=1-s,this.b1=-2*a,this.b2=1+s,this.a0=1+s,this.a1=-2*a,this.a2=1-s;break;case DSP.PEAKING_EQ:this.b0=1+s*e,this.b1=-2*a,this.b2=1-s*e,this.a0=1+s/e,this.a1=-2*a,this.a2=1-s/e;break;case DSP.LOW_SHELF:i=n*Math.sqrt((3^e)*(1/this.S-1)+2*e),this.b0=e*(e+1-(e-1)*a+i),this.b1=2*e*(e-1-(e+1)*a),this.b2=e*(e+1-(e-1)*a-i),this.a0=e+1+(e-1)*a+i,this.a1=-2*(e-1+(e+1)*a),this.a2=e+1+(e-1)*a-i;break;case DSP.HIGH_SHELF:i=n*Math.sqrt((3^e)*(1/this.S-1)+2*e),this.b0=e*(e+1+(e-1)*a+i),this.b1=-2*e*(e-1+(e+1)*a),this.b2=e*(e+1+(e-1)*a-i),this.a0=e+1-(e-1)*a+i,this.a1=2*(e-1-(e+1)*a),this.a2=e+1-(e-1)*a-i}this.b0a0=this.b0/this.a0,this.b1a0=this.b1/this.a0,this.b2a0=this.b2/this.a0,this.a1a0=this.a1/this.a0,this.a2a0=this.a2/this.a0},this.process=function(t){for(var e=t.length,r=new Float32Array(e),a=0;a<t.length;a++)r[a]=this.b0a0*t[a]+this.b1a0*this.x_1_l+this.b2a0*this.x_2_l-this.a1a0*this.y_1_l-this.a2a0*this.y_2_l,this.y_2_l=this.y_1_l,this.y_1_l=r[a],this.x_2_l=this.x_1_l,this.x_1_l=t[a];return r},this.processStereo=function(t){for(var e=t.length,r=new Float32Array(e),a=0;a<e/2;a++)r[2*a]=this.b0a0*t[2*a]+this.b1a0*this.x_1_l+this.b2a0*this.x_2_l-this.a1a0*this.y_1_l-this.a2a0*this.y_2_l,this.y_2_l=this.y_1_l,this.y_1_l=r[2*a],this.x_2_l=this.x_1_l,this.x_1_l=t[2*a],r[2*a+1]=this.b0a0*t[2*a+1]+this.b1a0*this.x_1_r+this.b2a0*this.x_2_r-this.a1a0*this.y_1_r-this.a2a0*this.y_2_r,this.y_2_r=this.y_1_r,this.y_1_r=r[2*a+1],this.x_2_r=this.x_1_r,this.x_1_r=t[2*a+1];return r}}function GraphicalEq(t){this.FS=t,this.minFreq=40,this.maxFreq=16e3,this.bandsPerOctave=1,this.filters=[],this.freqzs=[],this.calculateFreqzs=!0,this.recalculateFilters=function(){var t=Math.round(Math.log(this.maxFreq/this.minFreq)*this.bandsPerOctave/Math.LN2);this.filters=[];for(var e=0;e<t;e++){var r=this.minFreq*Math.pow(2,e/this.bandsPerOctave),a=new Biquad(DSP.PEAKING_EQ,this.FS);a.setDbGain(0),a.setBW(1/this.bandsPerOctave),a.setF0(r),this.filters[e]=a,this.recalculateFreqz(e)}},this.setMinimumFrequency=function(t){this.minFreq=t,this.recalculateFilters()},this.setMaximumFrequency=function(t){this.maxFreq=t,this.recalculateFilters()},this.setBandsPerOctave=function(t){this.bandsPerOctave=t,this.recalculateFilters()},this.setBandGain=function(t,e){if(t<0||t>this.filters.length-1)throw"The band index of the graphical equalizer is out of bounds.";if(!e)throw"A gain must be passed.";this.filters[t].setDbGain(e),this.recalculateFreqz(t)},this.recalculateFreqz=function(t){if(this.calculateFreqzs){if(t<0||t>this.filters.length-1)throw"The band index of the graphical equalizer is out of bounds. "+t+" is out of [0, "+this.filters.length-1+"]";if(!this.w){this.w=Float32Array(400);for(var e=0;e<this.w.length;e++)this.w[e]=Math.PI/this.w.length*e}var r=[this.filters[t].b0,this.filters[t].b1,this.filters[t].b2],a=[this.filters[t].a0,this.filters[t].a1,this.filters[t].a2];this.freqzs[t]=DSP.mag2db(DSP.freqz(r,a,this.w))}},this.process=function(t){for(var e=t,r=0;r<this.filters.length;r++)e=this.filters[r].process(e);return e},this.processStereo=function(t){for(var e=t,r=0;r<this.filters.length;r++)e=this.filters[r].processStereo(e);return e}}function MultiDelay(t,e,r,a){this.delayBufferSamples=new Float32Array(t),this.delayInputPointer=e,this.delayOutputPointer=0,this.delayInSamples=e,this.masterVolume=r,this.delayVolume=a}function SingleDelay(t,e,r){this.delayBufferSamples=new Float32Array(t),this.delayInputPointer=e,this.delayOutputPointer=0,this.delayInSamples=e,this.delayVolume=r}function Reverb(t,e,r,a,n,s){this.delayInSamples=e,this.masterVolume=r,this.mixVolume=a,this.delayVolume=n,this.dampFrequency=s,this.NR_OF_MULTIDELAYS=6,this.NR_OF_SINGLEDELAYS=6,this.LOWPASSL=new IIRFilter2(DSP.LOWPASS,s,0,44100),this.LOWPASSR=new IIRFilter2(DSP.LOWPASS,s,0,44100),this.singleDelays=[];var i,o;for(i=0;i<this.NR_OF_SINGLEDELAYS;i++)o=1+i/7,this.singleDelays[i]=new SingleDelay(t,Math.round(this.delayInSamples*o),this.delayVolume);for(this.multiDelays=[],i=0;i<this.NR_OF_MULTIDELAYS;i++)o=1+i/10,this.multiDelays[i]=new MultiDelay(t,Math.round(this.delayInSamples*o),this.masterVolume,this.delayVolume)}var DSP={LEFT:0,RIGHT:1,MIX:2,SINE:1,TRIANGLE:2,SAW:3,SQUARE:4,LOWPASS:0,HIGHPASS:1,BANDPASS:2,NOTCH:3,BARTLETT:1,BARTLETTHANN:2,BLACKMAN:3,COSINE:4,GAUSS:5,HAMMING:6,HANN:7,LANCZOS:8,RECTANGULAR:9,TRIANGULAR:10,OFF:0,FW:1,BW:2,FWBW:3,TWO_PI:2*Math.PI};setupTypedArray("Float32Array","WebGLFloatArray"),setupTypedArray("Int32Array","WebGLIntArray"),setupTypedArray("Uint16Array","WebGLUnsignedShortArray"),setupTypedArray("Uint8Array","WebGLUnsignedByteArray"),DSP.invert=function(t){for(var e=0,r=t.length;e<r;e++)t[e]*=-1;return t},DSP.interleave=function(t,e){if(t.length!==e.length)throw"Can not interleave. Channel lengths differ.";for(var r=new Float32Array(2*t.length),a=0,n=t.length;a<n;a++)r[2*a]=t[a],r[2*a+1]=e[a];return r},DSP.deinterleave=function(){var t,e,r,a=[];return a[DSP.MIX]=function(t){for(var e=0,a=t.length/2;e<a;e++)r[e]=(t[2*e]+t[2*e+1])/2;return r},a[DSP.LEFT]=function(e){for(var r=0,a=e.length/2;r<a;r++)t[r]=e[2*r];return t},a[DSP.RIGHT]=function(t){for(var r=0,a=t.length/2;r<a;r++)e[r]=t[2*r+1];return e},function(n,s){return t=t||new Float32Array(s.length/2),e=e||new Float32Array(s.length/2),r=r||new Float32Array(s.length/2),s.length/2!==t.length&&(t=new Float32Array(s.length/2),e=new Float32Array(s.length/2),r=new Float32Array(s.length/2)),a[n](s)}}(),DSP.getChannel=DSP.deinterleave,DSP.mixSampleBuffers=function(t,e,r,a){for(var n=new Float32Array(t),s=0;s<t.length;s++)n[s]+=(r?-e[s]:e[s])/a;return n},DSP.LPF=0,DSP.HPF=1,DSP.BPF_CONSTANT_SKIRT=2,DSP.BPF_CONSTANT_PEAK=3,DSP.NOTCH=4,DSP.APF=5,DSP.PEAKING_EQ=6,DSP.LOW_SHELF=7,DSP.HIGH_SHELF=8,DSP.Q=1,DSP.BW=2,DSP.S=3,DSP.RMS=function(t){for(var e=0,r=0,a=t.length;r<a;r++)e+=t[r]*t[r];return Math.sqrt(e/a)},DSP.Peak=function(t){for(var e=0,r=0,a=t.length;r<a;r++)e=Math.abs(t[r])>e?Math.abs(t[r]):e;return e},DFT.prototype.forward=function(t){for(var e,r,a=this.real,n=this.imag,s=0;s<this.bufferSize/2;s++){e=0,r=0;for(var i=0;i<t.length;i++)e+=this.cosTable[s*i]*t[i],r+=this.sinTable[s*i]*t[i];a[s]=e,n[s]=r}return this.calculateSpectrum()},FFT.prototype.forward=function(t){var e=this.bufferSize,r=this.cosTable,a=this.sinTable,n=this.reverseTable,s=this.real,i=this.imag,o=(this.spectrum,Math.floor(Math.log(e)/Math.LN2));if(Math.pow(2,o)!==e)throw"Invalid buffer size, must be a power of 2.";if(e!==t.length)throw"Supplied buffer is not the same size as defined FFT. FFT Size: "+e+" Buffer Size: "+t.length;var h,u,l,f,c,p,d,y,g,_=1;for(g=0;g<e;g++)s[g]=t[n[g]],i[g]=0;for(;_<e;){h=r[_],u=a[_],l=1,f=0;for(var m=0;m<_;m++){for(g=m;g<e;)c=g+_,p=l*s[c]-f*i[c],d=l*i[c]+f*s[c],s[c]=s[g]-p,i[c]=i[g]-d,s[g]+=p,i[g]+=d,g+=_<<1;y=l,l=y*h-f*u,f=y*u+f*h}_<<=1}return this.calculateSpectrum()},FFT.prototype.inverse=function(t,e){var r=this.bufferSize,a=this.cosTable,n=this.sinTable,s=this.reverseTable;this.spectrum;t=t||this.real,e=e||this.imag;var i,o,h,u,l,f,c,p,d,y=1;for(d=0;d<r;d++)e[d]*=-1;var g=new Float32Array(r),_=new Float32Array(r);for(d=0;d<t.length;d++)g[d]=t[s[d]],_[d]=e[s[d]];for(t=g,e=_;y<r;){i=a[y],o=n[y],h=1,u=0;for(var m=0;m<y;m++){for(d=m;d<r;)l=d+y,f=h*t[l]-u*e[l],c=h*e[l]+u*t[l],t[l]=t[d]-f,e[l]=e[d]-c,t[d]+=f,e[d]+=c,d+=y<<1;p=h,h=p*i-u*o,u=p*o+u*i}y<<=1}var b=new Float32Array(r);for(d=0;d<r;d++)b[d]=t[d]/r;return b},RFFT.prototype.forward=function(t){var e,r,a,n,s,i,o,h,u,l,f,c,p,d,y,g,_,m,b,v,w,S,A,P,I,M,E=this.bufferSize,T=this.spectrum,F=this.trans,D=2*Math.PI,R=Math.sqrt,L=E>>>1,B=2/E;this.reverseBinPermute(F,t);for(var O=0,N=4;O<E;N*=4){for(var V=O;V<E;V+=N)_=F[V]-F[V+1],F[V]+=F[V+1],F[V+1]=_;O=2*(N-1)}for(e=2,n=E>>>1;n>>>=1;){O=0,e<<=1,N=e<<1,r=e>>>2,a=e>>>3;do{if(1!==r)for(V=O;V<E;V+=N)u=V,l=u+r,f=l+r,c=f+r,s=F[f]+F[c],F[c]-=F[f],F[f]=F[u]-s,F[u]+=s,u+=a,l+=a,f+=a,c+=a,s=F[f]+F[c],i=F[f]-F[c],s=-s*Math.SQRT1_2,i*=Math.SQRT1_2,_=F[l],F[c]=s+_,F[f]=s-_,F[l]=F[u]-i,F[u]+=i;else for(V=O;V<E;V+=N)u=V,l=u+r,f=l+r,c=f+r,s=F[f]+F[c],F[c]-=F[f],F[f]=F[u]-s,F[u]+=s;O=(N<<1)-e,N<<=2}while(O<E);S=D/e;for(var j=1;j<a;j++){A=j*S,b=Math.sin(A),m=Math.cos(A),v=4*m*(m*m-.75),w=4*b*(.75-b*b),O=0,N=e<<1;do{for(V=O;V<E;V+=N)u=V+j,l=u+r,f=l+r,c=f+r,p=V+r-j,d=p+r,y=d+r,g=y+r,i=F[y]*m-F[f]*b,s=F[y]*b+F[f]*m,h=F[g]*v-F[c]*w,o=F[g]*w+F[c]*v,_=i-h,i+=h,h=_,F[g]=i+F[d],F[f]=i-F[d],_=o-s,s+=o,o=_,F[c]=o+F[l],F[y]=o-F[l],F[d]=F[u]-s,F[u]+=s,F[l]=h+F[p],F[p]-=h;O=(N<<1)-e,N<<=2}while(O<E)}}for(;--L;)P=F[L],I=F[E-L-1],M=B*R(P*P+I*I),M>this.peak&&(this.peakBand=L,this.peak=M),T[L]=M;return T[0]=B*F[0],T},Sampler.prototype.applyEnvelope=function(){return this.envelope.process(this.signal),this.signal},Sampler.prototype.generate=function(){for(var t=(this.frameCount*this.bufferSize,this.playEnd*this.samples.length-this.playStart*this.samples.length),e=this.playStart*this.samples.length,r=this.playEnd*this.samples.length,a=0;a<this.bufferSize;a++){switch(this.loopMode){case DSP.OFF:this.playhead=Math.round(this.samplesProcessed*this.step+e),this.playhead<this.playEnd*this.samples.length?this.signal[a]=this.samples[this.playhead]*this.amplitude:this.signal[a]=0;break;case DSP.FW:this.playhead=Math.round(this.samplesProcessed*this.step%t+e),this.playhead<this.playEnd*this.samples.length&&(this.signal[a]=this.samples[this.playhead]*this.amplitude);break;case DSP.BW:this.playhead=r-Math.round(this.samplesProcessed*this.step%t),this.playhead<this.playEnd*this.samples.length&&(this.signal[a]=this.samples[this.playhead]*this.amplitude);break;case DSP.FWBW:Math.floor(this.samplesProcessed*this.step/t)%2===0?this.playhead=Math.round(this.samplesProcessed*this.step%t+e):this.playhead=r-Math.round(this.samplesProcessed*this.step%t),this.playhead<this.playEnd*this.samples.length&&(this.signal[a]=this.samples[this.playhead]*this.amplitude)}this.samplesProcessed++}return this.frameCount++,this.signal},Sampler.prototype.setFreq=function(t){var e=this.samplesProcessed*this.step;this.frequency=t,this.step=this.frequency/this.rootFrequency,this.samplesProcessed=Math.round(e/this.step)},Sampler.prototype.reset=function(){this.samplesProcessed=0,this.playhead=0},Oscillator.prototype.setAmp=function(t){if(!(t>=0&&t<=1))throw"Amplitude out of range (0..1).";this.amplitude=t},Oscillator.prototype.setFreq=function(t){this.frequency=t,this.cyclesPerSample=t/this.sampleRate},Oscillator.prototype.add=function(t){for(var e=0;e<this.bufferSize;e++)this.signal[e]+=t.signal[e];return this.signal},Oscillator.prototype.addSignal=function(t){for(var e=0;e<t.length&&!(e>=this.bufferSize);e++)this.signal[e]+=t[e];return this.signal},Oscillator.prototype.addEnvelope=function(t){this.envelope=t},Oscillator.prototype.applyEnvelope=function(){this.envelope.process(this.signal)},Oscillator.prototype.valueAt=function(t){return this.waveTable[t%this.waveTableLength]},Oscillator.prototype.generate=function(){for(var t,e=this.frameCount*this.bufferSize,r=this.waveTableLength*this.frequency/this.sampleRate,a=0;a<this.bufferSize;a++)t=Math.round((e+a)*r),this.signal[a]=this.waveTable[t%this.waveTableLength]*this.amplitude;return this.frameCount++,this.signal},Oscillator.Sine=function(t){return Math.sin(DSP.TWO_PI*t)},Oscillator.Square=function(t){return t<.5?1:-1},Oscillator.Saw=function(t){return 2*(t-Math.round(t))},Oscillator.Triangle=function(t){return 1-4*Math.abs(Math.round(t)-t)},Oscillator.Pulse=function(t){},ADSR.prototype.noteOn=function(){this.samplesProcessed=0,this.sustainSamples=this.sustainLength*this.sampleRate,this.update()},ADSR.prototype.noteOff=function(){this.sustainSamples=this.samplesProcessed-this.decaySamples,this.update()},ADSR.prototype.processSample=function(t){var e=0;return this.samplesProcessed<=this.attack?e=0+1*((this.samplesProcessed-0)/(this.attack-0)):this.samplesProcessed>this.attack&&this.samplesProcessed<=this.decay?e=1+(this.sustainLevel-1)*((this.samplesProcessed-this.attack)/(this.decay-this.attack)):this.samplesProcessed>this.decay&&this.samplesProcessed<=this.sustain?e=this.sustainLevel:this.samplesProcessed>this.sustain&&this.samplesProcessed<=this.release&&(e=this.sustainLevel+(0-this.sustainLevel)*((this.samplesProcessed-this.sustain)/(this.release-this.sustain))),t*e},ADSR.prototype.value=function(){var t=0;return this.samplesProcessed<=this.attack?t=0+1*((this.samplesProcessed-0)/(this.attack-0)):this.samplesProcessed>this.attack&&this.samplesProcessed<=this.decay?t=1+(this.sustainLevel-1)*((this.samplesProcessed-this.attack)/(this.decay-this.attack)):this.samplesProcessed>this.decay&&this.samplesProcessed<=this.sustain?t=this.sustainLevel:this.samplesProcessed>this.sustain&&this.samplesProcessed<=this.release&&(t=this.sustainLevel+(0-this.sustainLevel)*((this.samplesProcessed-this.sustain)/(this.release-this.sustain))),t},ADSR.prototype.process=function(t){for(var e=0;e<t.length;e++)t[e]*=this.value(),this.samplesProcessed++;return t},ADSR.prototype.isActive=function(){return!(this.samplesProcessed>this.release||this.samplesProcessed===-1)},ADSR.prototype.disable=function(){this.samplesProcessed=-1},IIRFilter.prototype.__defineGetter__("cutoff",function(){return this.func.cutoff}),IIRFilter.prototype.__defineGetter__("resonance",function(){return this.func.resonance}),IIRFilter.prototype.set=function(t,e){this.func.calcCoeff(t,e)},IIRFilter.prototype.process=function(t){this.func.process(t)},IIRFilter.prototype.addEnvelope=function(t){if(!(t instanceof ADSR))throw"Not an envelope.";this.func.addEnvelope(t)},IIRFilter.LP12=function(t,e,r){this.sampleRate=r,this.vibraPos=0,this.vibraSpeed=0,this.envelope=!1,this.calcCoeff=function(t,e){this.w=2*Math.PI*t/this.sampleRate,this.q=1-this.w/(2*(e+.5/(1+this.w))+this.w-2),this.r=this.q*this.q,this.c=this.r+1-2*Math.cos(this.w)*this.q,this.cutoff=t,this.resonance=e},this.calcCoeff(t,e),this.process=function(t){for(var e=0;e<t.length;e++)this.vibraSpeed+=(t[e]-this.vibraPos)*this.c,this.vibraPos+=this.vibraSpeed,this.vibraSpeed*=this.r,this.envelope?(t[e]=t[e]*(1-this.envelope.value())+this.vibraPos*this.envelope.value(),this.envelope.samplesProcessed++):t[e]=this.vibraPos}},IIRFilter.LP12.prototype.addEnvelope=function(t){this.envelope=t},IIRFilter2.prototype.process=function(t){for(var e,r,a=this.f,n=0;n<t.length;n++)e=t[n],a[3]=e-this.damp*a[2],a[0]=a[0]+this.freq*a[2],a[1]=a[3]-a[0],a[2]=this.freq*a[1]+a[2],r=.5*a[this.type],a[3]=e-this.damp*a[2],a[0]=a[0]+this.freq*a[2],a[1]=a[3]-a[0],a[2]=this.freq*a[1]+a[2],r+=.5*a[this.type],this.envelope?(t[n]=t[n]*(1-this.envelope.value())+r*this.envelope.value(),this.envelope.samplesProcessed++):t[n]=r},IIRFilter2.prototype.addEnvelope=function(t){if(!(t instanceof ADSR))throw"This is not an envelope.";this.envelope=t},IIRFilter2.prototype.set=function(t,e){this.calcCoeff(t,e)},WindowFunction.prototype.process=function(t){for(var e=t.length,r=0;r<e;r++)t[r]*=this.func(e,r,this.alpha);return t},WindowFunction.Bartlett=function(t,e){return 2/(t-1)*((t-1)/2-Math.abs(e-(t-1)/2))},WindowFunction.BartlettHann=function(t,e){return.62-.48*Math.abs(e/(t-1)-.5)-.38*Math.cos(DSP.TWO_PI*e/(t-1))},WindowFunction.Blackman=function(t,e,r){var a=(1-r)/2,n=.5,s=r/2;return a-n*Math.cos(DSP.TWO_PI*e/(t-1))+s*Math.cos(4*Math.PI*e/(t-1))},WindowFunction.Cosine=function(t,e){return Math.cos(Math.PI*e/(t-1)-Math.PI/2)},WindowFunction.Gauss=function(t,e,r){return Math.pow(Math.E,-.5*Math.pow((e-(t-1)/2)/(r*(t-1)/2),2))},WindowFunction.Hamming=function(t,e){return.54-.46*Math.cos(DSP.TWO_PI*e/(t-1))},WindowFunction.Hann=function(t,e){return.5*(1-Math.cos(DSP.TWO_PI*e/(t-1)))},WindowFunction.Lanczos=function(t,e){var r=2*e/(t-1)-1;return Math.sin(Math.PI*r)/(Math.PI*r)},WindowFunction.Rectangular=function(t,e){return 1},WindowFunction.Triangular=function(t,e){return 2/t*(t/2-Math.abs(e-(t-1)/2))},DSP.mag2db=function(t){for(var e=-120,r=Math.pow(10,e/20),a=Math.log,n=Math.max,s=Float32Array(t.length),i=0;i<t.length;i++)s[i]=20*a(n(t[i],r));return s},DSP.freqz=function(t,e,r){var a,n;if(!r)for(r=Float32Array(200),a=0;a<r.length;a++)r[a]=DSP.TWO_PI/r.length*a-Math.PI;var s=Float32Array(r.length),i=Math.sqrt,o=Math.cos,h=Math.sin;for(a=0;a<r.length;a++){var u={real:0,imag:0};for(n=0;n<t.length;n++)u.real+=t[n]*o(-n*r[a]),u.imag+=t[n]*h(-n*r[a]);var l={real:0,imag:0};for(n=0;n<e.length;n++)l.real+=e[n]*o(-n*r[a]),l.imag+=e[n]*h(-n*r[a]);s[a]=i(u.real*u.real+u.imag*u.imag)/i(l.real*l.real+l.imag*l.imag)}return s},MultiDelay.prototype.setDelayInSamples=function(t){this.delayInSamples=t,this.delayInputPointer=this.delayOutputPointer+t,this.delayInputPointer>=this.delayBufferSamples.length-1&&(this.delayInputPointer=this.delayInputPointer-this.delayBufferSamples.length)},MultiDelay.prototype.setMasterVolume=function(t){this.masterVolume=t},MultiDelay.prototype.setDelayVolume=function(t){this.delayVolume=t},MultiDelay.prototype.process=function(t){for(var e=new Float32Array(t.length),r=0;r<t.length;r++){var a=null===this.delayBufferSamples[this.delayOutputPointer]?0:this.delayBufferSamples[this.delayOutputPointer],n=a*this.delayVolume+t[r];this.delayBufferSamples[this.delayInputPointer]=n,e[r]=n*this.masterVolume,this.delayInputPointer++,this.delayInputPointer>=this.delayBufferSamples.length-1&&(this.delayInputPointer=0),this.delayOutputPointer++,this.delayOutputPointer>=this.delayBufferSamples.length-1&&(this.delayOutputPointer=0)}return e},SingleDelay.prototype.setDelayInSamples=function(t){this.delayInSamples=t,this.delayInputPointer=this.delayOutputPointer+t,this.delayInputPointer>=this.delayBufferSamples.length-1&&(this.delayInputPointer=this.delayInputPointer-this.delayBufferSamples.length)},SingleDelay.prototype.setDelayVolume=function(t){this.delayVolume=t},SingleDelay.prototype.process=function(t){for(var e=new Float32Array(t.length),r=0;r<t.length;r++){this.delayBufferSamples[this.delayInputPointer]=t[r];var a=this.delayBufferSamples[this.delayOutputPointer];e[r]=a*this.delayVolume,this.delayInputPointer++,this.delayInputPointer>=this.delayBufferSamples.length-1&&(this.delayInputPointer=0),this.delayOutputPointer++,this.delayOutputPointer>=this.delayBufferSamples.length-1&&(this.delayOutputPointer=0)}return e},Reverb.prototype.setDelayInSamples=function(t){this.delayInSamples=t;var e,r;for(e=0;e<this.NR_OF_SINGLEDELAYS;e++)r=1+e/7,this.singleDelays[e].setDelayInSamples(Math.round(this.delayInSamples*r));for(e=0;e<this.NR_OF_MULTIDELAYS;e++)r=1+e/10,this.multiDelays[e].setDelayInSamples(Math.round(this.delayInSamples*r))},Reverb.prototype.setMasterVolume=function(t){this.masterVolume=t},Reverb.prototype.setMixVolume=function(t){this.mixVolume=t},Reverb.prototype.setDelayVolume=function(t){this.delayVolume=t;var e;for(e=0;e<this.NR_OF_SINGLEDELAYS;e++)this.singleDelays[e].setDelayVolume(this.delayVolume);for(e=0;e<this.NR_OF_MULTIDELAYS;e++)this.multiDelays[e].setDelayVolume(this.delayVolume)},Reverb.prototype.setDampFrequency=function(t){this.dampFrequency=t,this.LOWPASSL.set(t,0),this.LOWPASSR.set(t,0)},Reverb.prototype.process=function(t){var e=new Float32Array(t.length),r=DSP.deinterleave(t);this.LOWPASSL.process(r[DSP.LEFT]),this.LOWPASSR.process(r[DSP.RIGHT]);var a,n=DSP.interleave(r[DSP.LEFT],r[DSP.RIGHT]);for(a=0;a<this.NR_OF_MULTIDELAYS;a++)e=DSP.mixSampleBuffers(e,this.multiDelays[a].process(n),2%a===0,this.NR_OF_MULTIDELAYS);var s=new Float32Array(e.length);for(a=0;a<this.NR_OF_SINGLEDELAYS;a++)s=DSP.mixSampleBuffers(s,this.singleDelays[a].process(e),2%a===0,1);for(a=0;a<s.length;a++)s[a]*=this.mixVolume;for(e=DSP.mixSampleBuffers(s,t,0,1),a=0;a<e.length;a++)e[a]*=this.masterVolume;return e},require=function t(e,r,a){function n(i,o){if(!r[i]){if(!e[i]){var h="function"==typeof require&&require;if(!o&&h)return h(i,!0);if(s)return s(i,!0);var u=new Error("Cannot find module '"+i+"'");throw u.code="MODULE_NOT_FOUND",u}var l=r[i]={exports:{}};e[i][0].call(l.exports,function(t){var r=e[i][1][t];return n(r?r:t)},l,l.exports,t,e,r,a)}return r[i].exports}for(var s="function"==typeof require&&require,i=0;i<a.length;i++)n(a[i]);return n}({1:[function(t,e,r){function a(t,e,r,a,n,h,u){t|=0,e|=0,r|=0,n|=0,h|=0,o.isPow2(r)?s(t,e,r,a,n,h):i(t,e,r,a,n,h,u)}function n(t){return o.isPow2(t)?0:2*t+4*o.nextPow2(2*t+1)}function s(t,e,r,a,n,s){t|=0,e|=0,r|=0,n|=0,s|=0;var i,h,u,l,f,c,p,d,y,g,_,b,v,w,S,A,P,I,M,E,T,F,D,R;for(i=r,m=o.log2(i),P=0;P<e;++P){for(c=i>>1,l=0,h=0;h<i-1;h++){for(h<l&&(b=a[n+h],a[n+h]=a[n+l],a[n+l]=b,b=a[s+h],a[s+h]=a[s+l],a[s+l]=b),f=c;f<=l;)l-=f,f>>=1;l+=f}for(g=-1,_=0,y=1,p=0;p<m;p++){for(d=y,y<<=1,S=1,A=0,l=0;l<d;l++){for(h=l;h<i;h+=y)u=h+d,I=a[n+u],M=a[s+u],E=a[n+h],T=a[s+h],F=S*(I+M),D=I*(A-S),R=M*(S+A),v=F-R,w=F+D,a[n+u]=E-v,a[s+u]=T-w,a[n+h]+=v,a[s+h]+=w;F=g*(S+A),D=S*(_-g),R=A*(g+_),S=F-R,A=F+D}_=Math.sqrt((1-g)/2),t<0&&(_=-_),g=Math.sqrt((1+g)/2)}if(t<0){var L=1/i;for(h=0;h<i;h++)a[n+h]*=L,a[s+h]*=L}n+=r,s+=r}}function i(t,e,r,a,n,i,h){t|=0,e|=0,r|=0,n|=0,i|=0,h|=0;var u,l,f,c,p,d,y,g,_,m=o.nextPow2(2*r+1),b=h,v=b+r,w=v+r,S=w+m,A=S+m,P=A+m,I=-t*Math.PI/r;for(_=0;_<r;++_)l=I*(_*_%(2*r)),c=Math.cos(l),p=Math.sin(l),a[A+(m-_)]=a[A+_]=a[b+_]=c,a[P+(m-_)]=a[P+_]=a[v+_]=p;for(_=r;_<=m-r;++_)a[A+_]=0;for(_=r;_<=m-r;++_)a[P+_]=0;for(s(1,1,m,a,A,P),I=t<0?1/r:1,u=0;u<e;++u){for(_=0;_<r;++_)l=a[n+_],f=a[i+_],c=a[b+_],p=-a[v+_],d=c*(l+f),y=l*(p-c),g=f*(c+p),a[w+_]=d-g,a[S+_]=d+y;for(_=r;_<m;++_)a[w+_]=0;for(_=r;_<m;++_)a[S+_]=0;for(s(1,1,m,a,w,S),_=0;_<m;++_)l=a[w+_],f=a[S+_],c=a[A+_],p=a[P+_],d=c*(l+f),y=l*(p-c),g=f*(c+p),a[w+_]=d-g,a[S+_]=d+y;for(s(-1,1,m,a,w,S),_=0;_<r;++_)l=a[w+_],f=a[S+_],c=a[b+_],p=-a[v+_],d=c*(l+f),y=l*(p-c),g=f*(c+p),a[n+_]=I*(d-g),a[i+_]=I*(d+y);n+=r,i+=r}}var o=t("bit-twiddle");e.exports=a,e.exports.scratchMemory=n},{"bit-twiddle":2}],2:[function(t,e,r){"use strict";"use restrict";function a(t){var e=32;return t&=-t,t&&e--,65535&t&&(e-=16),16711935&t&&(e-=8),252645135&t&&(e-=4),858993459&t&&(e-=2),1431655765&t&&(e-=1),e}var n=32;r.INT_BITS=n,r.INT_MAX=2147483647,r.INT_MIN=-1<<n-1,r.sign=function(t){return(t>0)-(t<0)},r.abs=function(t){var e=t>>n-1;return(t^e)-e},r.min=function(t,e){return e^(t^e)&-(t<e)},r.max=function(t,e){return t^(t^e)&-(t<e)},r.isPow2=function(t){return!(t&t-1||!t)},r.log2=function(t){var e,r;return e=(t>65535)<<4,t>>>=e,r=(t>255)<<3,t>>>=r,e|=r,r=(t>15)<<2,t>>>=r,e|=r,r=(t>3)<<1,t>>>=r,e|=r,e|t>>1},r.log10=function(t){return t>=1e9?9:t>=1e8?8:t>=1e7?7:t>=1e6?6:t>=1e5?5:t>=1e4?4:t>=1e3?3:t>=100?2:t>=10?1:0},r.popCount=function(t){return t-=t>>>1&1431655765,t=(858993459&t)+(t>>>2&858993459),16843009*(t+(t>>>4)&252645135)>>>24},r.countTrailingZeros=a,r.nextPow2=function(t){return t+=0===t,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t+1},r.prevPow2=function(t){return t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t-(t>>>1)},r.parity=function(t){return t^=t>>>16,t^=t>>>8,t^=t>>>4,t&=15,27030>>>t&1};var s=new Array(256);!function(t){for(var e=0;e<256;++e){var r=e,a=e,n=7;for(r>>>=1;r;r>>>=1)a<<=1,a|=1&r,--n;t[e]=a<<n&255}}(s),r.reverse=function(t){return s[255&t]<<24|s[t>>>8&255]<<16|s[t>>>16&255]<<8|s[t>>>24&255]},r.interleave2=function(t,e){return t&=65535,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e&=65535,e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t|e<<1},r.deinterleave2=function(t,e){return t=t>>>e&1431655765,t=858993459&(t|t>>>1),t=252645135&(t|t>>>2),t=16711935&(t|t>>>4),t=65535&(t|t>>>16),t<<16>>16},r.interleave3=function(t,e,r){return t&=1023,t=4278190335&(t|t<<16),t=251719695&(t|t<<8),t=3272356035&(t|t<<4),t=1227133513&(t|t<<2),e&=1023,e=4278190335&(e|e<<16),e=251719695&(e|e<<8),e=3272356035&(e|e<<4),e=1227133513&(e|e<<2),t|=e<<1,r&=1023,r=4278190335&(r|r<<16),r=251719695&(r|r<<8),r=3272356035&(r|r<<4),r=1227133513&(r|r<<2),t|r<<2},r.deinterleave3=function(t,e){return t=t>>>e&1227133513,t=3272356035&(t|t>>>2),t=251719695&(t|t>>>4),t=4278190335&(t|t>>>8),t=1023&(t|t>>>16),t<<22>>22},r.nextCombination=function(t){var e=t|t-1;return e+1|(~e&-~e)-1>>>a(t)+1}},{}],3:[function(t,e,r){"use strict";function a(t){if(!t)return o;for(var e=0;e<t.args.length;++e){var r=t.args[e];0===e?t.args[e]={name:r,lvalue:!0,rvalue:!!t.rvalue,count:t.count||1}:t.args[e]={name:r,lvalue:!1,rvalue:!0,count:1}}return t.thisVars||(t.thisVars=[]),t.localVars||(t.localVars=[]),t}function n(t){return i({args:t.args,pre:a(t.pre),body:a(t.body),post:a(t.proc),funcName:t.funcName})}function s(t){for(var e=[],r=0;r<t.args.length;++r)e.push("a"+r);var a=new Function("P",["return function ",t.funcName,"_ndarrayops(",e.join(","),") {P(",e.join(","),");return a0}"].join(""));
return a(n(t))}var i=t("cwise-compiler"),o={body:"",args:[],thisVars:[],localVars:[]},h={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};!function(){for(var t in h){var e=h[t];r[t]=s({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+e+"c"},funcName:t}),r[t+"eq"]=s({args:["array","array"],body:{args:["a","b"],body:"a"+e+"=b"},rvalue:!0,funcName:t+"eq"}),r[t+"s"]=s({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+e+"s"},funcName:t+"s"}),r[t+"seq"]=s({args:["array","scalar"],body:{args:["a","s"],body:"a"+e+"=s"},rvalue:!0,funcName:t+"seq"})}}();var u={not:"!",bnot:"~",neg:"-",recip:"1.0/"};!function(){for(var t in u){var e=u[t];r[t]=s({args:["array","array"],body:{args:["a","b"],body:"a="+e+"b"},funcName:t}),r[t+"eq"]=s({args:["array"],body:{args:["a"],body:"a="+e+"a"},rvalue:!0,count:2,funcName:t+"eq"})}}();var l={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};!function(){for(var t in l){var e=l[t];r[t]=s({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+e+"c"},funcName:t}),r[t+"s"]=s({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+e+"s"},funcName:t+"s"}),r[t+"eq"]=s({args:["array","array"],body:{args:["a","b"],body:"a=a"+e+"b"},rvalue:!0,count:2,funcName:t+"eq"}),r[t+"seq"]=s({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+e+"s"},rvalue:!0,count:2,funcName:t+"seq"})}}();var f=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"];!function(){for(var t=0;t<f.length;++t){var e=f[t];r[e]=s({args:["array","array"],pre:{args:[],body:"this_f=Math."+e,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:e}),r[e+"eq"]=s({args:["array"],pre:{args:[],body:"this_f=Math."+e,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:e+"eq"})}}();var c=["max","min","atan2","pow"];!function(){for(var t=0;t<c.length;++t){var e=c[t];r[e]=s({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+e,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:e}),r[e+"s"]=s({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+e,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:e+"s"}),r[e+"eq"]=s({args:["array","array"],pre:{args:[],body:"this_f=Math."+e,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:e+"eq"}),r[e+"seq"]=s({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+e,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:e+"seq"})}}();var p=["atan2","pow"];!function(){for(var t=0;t<p.length;++t){var e=p[t];r[e+"op"]=s({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+e,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:e+"op"}),r[e+"ops"]=s({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+e,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:e+"ops"}),r[e+"opeq"]=s({args:["array","array"],pre:{args:[],body:"this_f=Math."+e,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:e+"opeq"}),r[e+"opseq"]=s({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+e,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:e+"opseq"})}}(),r.any=i({args:["array"],pre:o,body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"}),r.all=i({args:["array"],pre:o,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"}),r.sum=i({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"}),r.prod=i({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"}),r.norm2squared=i({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"}),r.norm2=i({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"}),r.norminf=i({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"}),r.norm1=i({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"}),r.sup=i({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),r.inf=i({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),r.argmin=i({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),r.argmax=i({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),r.random=s({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"}),r.assign=s({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"}),r.assigns=s({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"}),r.equals=i({args:["array","array"],pre:o,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1},{name:"y",lvalue:!1,rvalue:!0,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})},{"cwise-compiler":4}],4:[function(t,e,r){"use strict";function a(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1}function n(t){var e=new a;e.pre=t.pre,e.body=t.body,e.post=t.post;var r=t.args.slice(0);e.argTypes=r;for(var n=0;n<r.length;++n){var i=r[n];if("array"===i){if(e.arrayArgs.push(n),e.shimArgs.push("array"+n),n<e.pre.args.length&&e.pre.args[n].count>0)throw new Error("cwise: pre() block may not reference array args");if(n<e.post.args.length&&e.post.args[n].count>0)throw new Error("cwise: post() block may not reference array args")}else if("scalar"===i)e.scalarArgs.push(n),e.shimArgs.push("scalar"+n);else if("index"===i){if(e.indexArgs.push(n),n<e.pre.args.length&&e.pre.args[n].count>0)throw new Error("cwise: pre() block may not reference array index");if(n<e.body.args.length&&e.body.args[n].lvalue)throw new Error("cwise: body() block may not write to array index");if(n<e.post.args.length&&e.post.args[n].count>0)throw new Error("cwise: post() block may not reference array index")}else if("shape"===i){if(e.shapeArgs.push(n),n<e.pre.args.length&&e.pre.args[n].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(n<e.body.args.length&&e.body.args[n].lvalue)throw new Error("cwise: body() block may not write to array shape");if(n<e.post.args.length&&e.post.args[n].lvalue)throw new Error("cwise: post() block may not write to array shape")}else{if("object"!=typeof i||!i.offset)throw new Error("cwise: Unknown argument type "+r[n]);e.argTypes[n]="offset",e.offsetArgs.push({array:i.array,offset:i.offset}),e.offsetArgIndex.push(n)}}if(e.arrayArgs.length<=0)throw new Error("cwise: No array arguments specified");if(e.pre.args.length>r.length)throw new Error("cwise: Too many arguments in pre() block");if(e.body.args.length>r.length)throw new Error("cwise: Too many arguments in body() block");if(e.post.args.length>r.length)throw new Error("cwise: Too many arguments in post() block");return e.debug=!!t.printCode||!!t.debug,e.funcName=t.funcName||"cwise",e.blockSize=t.blockSize||64,s(e)}var s=t("./lib/thunk.js");e.exports=n},{"./lib/thunk.js":6}],5:[function(t,e,r){"use strict";function a(t,e,r){var a,n,s=t.length,i=e.arrayArgs.length,o=e.indexArgs.length>0,h=[],u=[],l=0,f=0;for(a=0;a<s;++a)u.push(["i",a,"=0"].join(""));for(n=0;n<i;++n)for(a=0;a<s;++a)f=l,l=t[a],0===a?u.push(["d",n,"s",a,"=t",n,"p",l].join("")):u.push(["d",n,"s",a,"=(t",n,"p",l,"-s",f,"*t",n,"p",f,")"].join(""));for(h.push("var "+u.join(",")),a=s-1;a>=0;--a)l=t[a],h.push(["for(i",a,"=0;i",a,"<s",l,";++i",a,"){"].join(""));for(h.push(r),a=0;a<s;++a){for(f=l,l=t[a],n=0;n<i;++n)h.push(["p",n,"+=d",n,"s",a].join(""));o&&(a>0&&h.push(["index[",f,"]-=s",f].join("")),h.push(["++index[",l,"]"].join(""))),h.push("}")}return h.join("\n")}function n(t,e,r,n){for(var s=e.length,i=r.arrayArgs.length,o=r.blockSize,h=r.indexArgs.length>0,u=[],l=0;l<i;++l)u.push(["var offset",l,"=p",l].join(""));for(var l=t;l<s;++l)u.push(["for(var j"+l+"=SS[",e[l],"]|0;j",l,">0;){"].join("")),u.push(["if(j",l,"<",o,"){"].join("")),u.push(["s",e[l],"=j",l].join("")),u.push(["j",l,"=0"].join("")),u.push(["}else{s",e[l],"=",o].join("")),u.push(["j",l,"-=",o,"}"].join("")),h&&u.push(["index[",e[l],"]=j",l].join(""));for(var l=0;l<i;++l){for(var f=["offset"+l],c=t;c<s;++c)f.push(["j",c,"*t",l,"p",e[c]].join(""));u.push(["p",l,"=(",f.join("+"),")"].join(""))}u.push(a(e,r,n));for(var l=t;l<s;++l)u.push("}");return u.join("\n")}function s(t){for(var e=0,r=t[0].length;e<r;){for(var a=1;a<t.length;++a)if(t[a][e]!==t[0][e])return e;++e}return e}function i(t,e,r){for(var a=t.body,n=[],s=[],i=0;i<t.args.length;++i){var o=t.args[i];if(!(o.count<=0)){var h=new RegExp(o.name,"g"),u="",l=e.arrayArgs.indexOf(i);switch(e.argTypes[i]){case"offset":var f=e.offsetArgIndex.indexOf(i),c=e.offsetArgs[f];l=c.array,u="+q"+f;case"array":u="p"+l+u;var p="l"+i,d="a"+l;1===o.count?"generic"===r[l]?o.lvalue?(n.push(["var ",p,"=",d,".get(",u,")"].join("")),a=a.replace(h,p),s.push([d,".set(",u,",",p,")"].join(""))):a=a.replace(h,[d,".get(",u,")"].join("")):a=a.replace(h,[d,"[",u,"]"].join("")):"generic"===r[l]?(n.push(["var ",p,"=",d,".get(",u,")"].join("")),a=a.replace(h,p),o.lvalue&&s.push([d,".set(",u,",",p,")"].join(""))):(n.push(["var ",p,"=",d,"[",u,"]"].join("")),a=a.replace(h,p),o.lvalue&&s.push([d,"[",u,"]=",p].join("")));break;case"scalar":a=a.replace(h,"Y"+e.scalarArgs.indexOf(i));break;case"index":a=a.replace(h,"index");break;case"shape":a=a.replace(h,"shape")}}}return[n.join("\n"),a,s.join("\n")].join("\n").trim()}function o(t){for(var e=new Array(t.length),r=!0,a=0;a<t.length;++a){var n=t[a],s=n.match(/\d+/);s=s?s[0]:"",0===n.charAt(0)?e[a]="u"+n.charAt(1)+s:e[a]=n.charAt(0)+s,a>0&&(r=r&&e[a]===e[a-1])}return r?e[0]:e.join("")}function h(t,e){for(var r=0|e[1].length,h=new Array(t.arrayArgs.length),l=new Array(t.arrayArgs.length),f=["SS"],c=["'use strict'"],p=[],d=0;d<r;++d)p.push(["s",d,"=SS[",d,"]"].join(""));for(var y=0;y<t.arrayArgs.length;++y){f.push("a"+y),f.push("t"+y),f.push("p"+y),l[y]=e[2*y],h[y]=e[2*y+1];for(var d=0;d<r;++d)p.push(["t",y,"p",d,"=t",y,"[",d,"]"].join(""))}for(var y=0;y<t.scalarArgs.length;++y)f.push("Y"+y);if(t.shapeArgs.length>0&&p.push("shape=SS.slice(0)"),t.indexArgs.length>0){for(var g=new Array(r),y=0;y<r;++y)g[y]="0";p.push(["index=[",g.join(","),"]"].join(""))}for(var y=0;y<t.offsetArgs.length;++y){for(var _=t.offsetArgs[y],m=[],d=0;d<_.offset.length;++d)0!==_.offset[d]&&(1===_.offset[d]?m.push(["t",_.array,"p",d].join("")):m.push([_.offset[d],"*t",_.array,"p",d].join("")));0===m.length?p.push("q"+y+"=0"):p.push(["q",y,"=",m.join("+")].join(""))}var b=u([].concat(t.pre.thisVars).concat(t.body.thisVars).concat(t.post.thisVars));p=p.concat(b),c.push("var "+p.join(","));for(var y=0;y<t.arrayArgs.length;++y)c.push("p"+y+"|=0");t.pre.body.length>3&&c.push(i(t.pre,t,l));var v=i(t.body,t,l),w=s(h);w<r?c.push(n(w,h[0],t,v)):c.push(a(h[0],t,v)),t.post.body.length>3&&c.push(i(t.post,t,l)),t.debug&&console.log("Generated cwise routine for ",e,":\n\n",c.join("\n"));var S=[t.funcName||"unnamed","_cwise_loop_",h[0].join("s"),"m",w,o(l)].join(""),A=new Function(["function ",S,"(",f.join(","),"){",c.join("\n"),"} return ",S].join(""));return A()}var u=t("uniq");e.exports=h},{uniq:7}],6:[function(t,e,r){"use strict";function a(t){var e=["'use strict'","var CACHED={}"],r=[],a=t.funcName+"_cwise_thunk";e.push(["return function ",a,"(",t.shimArgs.join(","),"){"].join(""));for(var s=[],i=[],o=[["array",t.arrayArgs[0],".shape"].join("")],h=0;h<t.arrayArgs.length;++h){var u=t.arrayArgs[h];r.push(["t",u,"=array",u,".dtype,","r",u,"=array",u,".order"].join("")),s.push("t"+u),s.push("r"+u),i.push("t"+u),i.push("r"+u+".join()"),o.push("array"+u+".data"),o.push("array"+u+".stride"),o.push("array"+u+".offset|0")}for(var h=0;h<t.scalarArgs.length;++h)o.push("scalar"+t.scalarArgs[h]);r.push(["type=[",i.join(","),"].join()"].join("")),r.push("proc=CACHED[type]"),e.push("var "+r.join(",")),e.push(["if(!proc){","CACHED[type]=proc=compile([",s.join(","),"])}","return proc(",o.join(","),")}"].join("")),t.debug&&console.log("Generated thunk:",e.join("\n"));var l=new Function("compile",e.join("\n"));return l(n.bind(void 0,t))}var n=t("./compile.js");e.exports=a},{"./compile.js":5}],7:[function(t,e,r){"use strict";function a(t,e){for(var r=1,a=t.length,n=t[0],s=t[0],i=1;i<a;++i)if(s=n,n=t[i],e(n,s)){if(i===r){r++;continue}t[r++]=n}return t.length=r,t}function n(t){for(var e=1,r=t.length,a=t[0],n=t[0],s=1;s<r;++s,n=a)if(n=a,a=t[s],a!==n){if(s===e){e++;continue}t[e++]=a}return t.length=e,t}function s(t,e,r){return 0===t.length?t:e?(r||t.sort(e),a(t,e)):(r||t.sort(),n(t))}e.exports=s},{}],8:[function(t,e,r){"use strict";function a(t,e,r){var n=0|t[r];if(n<=0)return[];var s,i=new Array(n);if(r===t.length-1)for(s=0;s<n;++s)i[s]=e;else for(s=0;s<n;++s)i[s]=a(t,e,r+1);return i}function n(t,e){var r,a;for(r=new Array(t),a=0;a<t;++a)r[a]=e;return r}function s(t,e){switch("undefined"==typeof e&&(e=0),typeof t){case"number":if(t>0)return n(0|t,e);break;case"object":if("number"==typeof t.length)return a(t,e,0)}return[]}e.exports=s},{}],9:[function(t,e,r){(function(e,a){"use strict";function n(t){if(t){var e=t.length||t.byteLength,r=m.log2(e);S[r].push(t)}}function s(t){n(t.buffer)}function i(t){var t=m.nextPow2(t),e=m.log2(t),r=S[e];return r.length>0?r.pop():new ArrayBuffer(t)}function o(t){return new Uint8Array(i(t),0,t)}function h(t){return new Uint16Array(i(2*t),0,t)}function u(t){return new Uint32Array(i(4*t),0,t)}function l(t){return new Int8Array(i(t),0,t)}function f(t){return new Int16Array(i(2*t),0,t)}function c(t){return new Int32Array(i(4*t),0,t)}function p(t){return new Float32Array(i(4*t),0,t)}function d(t){return new Float64Array(i(8*t),0,t)}function y(t){return v?new Uint8ClampedArray(i(t),0,t):o(t)}function g(t){return new DataView(i(t),0,t)}function _(t){t=m.nextPow2(t);var e=m.log2(t),r=A[e];return r.length>0?r.pop():new a(t)}var m=t("bit-twiddle"),b=t("dup");e.__TYPEDARRAY_POOL||(e.__TYPEDARRAY_POOL={UINT8:b([32,0]),UINT16:b([32,0]),UINT32:b([32,0]),INT8:b([32,0]),INT16:b([32,0]),INT32:b([32,0]),FLOAT:b([32,0]),DOUBLE:b([32,0]),DATA:b([32,0]),UINT8C:b([32,0]),BUFFER:b([32,0])});var v="undefined"!=typeof Uint8ClampedArray,w=e.__TYPEDARRAY_POOL;w.UINT8C||(w.UINT8C=b([32,0])),w.BUFFER||(w.BUFFER=b([32,0]));var S=w.DATA,A=w.BUFFER;r.free=function(t){if(a.isBuffer(t))A[m.log2(t.length)].push(t);else{if("[object ArrayBuffer]"!==Object.prototype.toString.call(t)&&(t=t.buffer),!t)return;var e=t.length||t.byteLength,r=0|m.log2(e);S[r].push(t)}},r.freeUint8=r.freeUint16=r.freeUint32=r.freeInt8=r.freeInt16=r.freeInt32=r.freeFloat32=r.freeFloat=r.freeFloat64=r.freeDouble=r.freeUint8Clamped=r.freeDataView=s,r.freeArrayBuffer=n,r.freeBuffer=function(t){A[m.log2(t.length)].push(t)},r.malloc=function(t,e){if(void 0===e||"arraybuffer"===e)return i(t);switch(e){case"uint8":return o(t);case"uint16":return h(t);case"uint32":return u(t);case"int8":return l(t);case"int16":return f(t);case"int32":return c(t);case"float":case"float32":return p(t);case"double":case"float64":return d(t);case"uint8_clamped":return y(t);case"buffer":return _(t);case"data":case"dataview":return g(t);default:return null}return null},r.mallocArrayBuffer=i,r.mallocUint8=o,r.mallocUint16=h,r.mallocUint32=u,r.mallocInt8=l,r.mallocInt16=f,r.mallocInt32=c,r.mallocFloat32=r.mallocFloat=p,r.mallocFloat64=r.mallocDouble=d,r.mallocUint8Clamped=y,r.mallocDataView=g,r.mallocBuffer=_,r.clearCache=function(){for(var t=0;t<32;++t)w.UINT8[t].length=0,w.UINT16[t].length=0,w.UINT32[t].length=0,w.INT8[t].length=0,w.INT16[t].length=0,w.INT32[t].length=0,w.FLOAT[t].length=0,w.DOUBLE[t].length=0,w.UINT8C[t].length=0,S[t].length=0,A[t].length=0}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},t("buffer").Buffer)},{"bit-twiddle":2,buffer:11,dup:8}],10:[function(t,e,r){"use strict";function a(t){for(var e=new Array(t),r=0;r<t;++r)e[r]=r;return e}e.exports=a},{}],11:[function(t,e,r){function a(t,e){var r=this;if(!(r instanceof a))return new a(t,e);var n,s=typeof t;if("number"===s)n=+t;else if("string"===s)n=a.byteLength(t,e);else{if("object"!==s||null===t)throw new TypeError("must start with number, buffer, array or string");"Buffer"===t.type&&V(t.data)&&(t=t.data),n=+t.length}if(n>j)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+j.toString(16)+" bytes");n<0?n=0:n>>>=0,a.TYPED_ARRAY_SUPPORT?r=a._augment(new Uint8Array(n)):(r.length=n,r._isBuffer=!0);var i;if(a.TYPED_ARRAY_SUPPORT&&"number"==typeof t.byteLength)r._set(t);else if(M(t))if(a.isBuffer(t))for(i=0;i<n;i++)r[i]=t.readUInt8(i);else for(i=0;i<n;i++)r[i]=(t[i]%256+256)%256;else if("string"===s)r.write(t,0,e);else if("number"===s&&!a.TYPED_ARRAY_SUPPORT)for(i=0;i<n;i++)r[i]=0;return n>0&&n<=a.poolSize&&(r.parent=x),r}function n(t,e){if(!(this instanceof n))return new n(t,e);var r=new a(t,e);return delete r.parent,r}function s(t,e,r,a){r=Number(r)||0;var n=t.length-r;a?(a=Number(a),a>n&&(a=n)):a=n;var s=e.length;if(s%2!==0)throw new Error("Invalid hex string");a>s/2&&(a=s/2);for(var i=0;i<a;i++){var o=parseInt(e.substr(2*i,2),16);if(isNaN(o))throw new Error("Invalid hex string");t[r+i]=o}return i}function i(t,e,r,a){var n=L(T(e,t.length-r),t,r,a);return n}function o(t,e,r,a){var n=L(F(e),t,r,a);return n}function h(t,e,r,a){return o(t,e,r,a)}function u(t,e,r,a){var n=L(R(e),t,r,a);return n}function l(t,e,r,a){var n=L(D(e,t.length-r),t,r,a);return n}function f(t,e,r){return 0===e&&r===t.length?O.fromByteArray(t):O.fromByteArray(t.slice(e,r))}function c(t,e,r){var a="",n="";r=Math.min(t.length,r);for(var s=e;s<r;s++)t[s]<=127?(a+=B(n)+String.fromCharCode(t[s]),n=""):n+="%"+t[s].toString(16);return a+B(n)}function p(t,e,r){var a="";r=Math.min(t.length,r);for(var n=e;n<r;n++)a+=String.fromCharCode(127&t[n]);return a}function d(t,e,r){var a="";r=Math.min(t.length,r);for(var n=e;n<r;n++)a+=String.fromCharCode(t[n]);return a}function y(t,e,r){var a=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>a)&&(r=a);for(var n="",s=e;s<r;s++)n+=E(t[s]);return n}function g(t,e,r){for(var a=t.slice(e,r),n="",s=0;s<a.length;s+=2)n+=String.fromCharCode(a[s]+256*a[s+1]);return n}function _(t,e,r){if(t%1!==0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function m(t,e,r,n,s,i){if(!a.isBuffer(t))throw new TypeError("buffer must be a Buffer instance");if(e>s||e<i)throw new RangeError("value is out of bounds");if(r+n>t.length)throw new RangeError("index out of range")}function b(t,e,r,a){e<0&&(e=65535+e+1);for(var n=0,s=Math.min(t.length-r,2);n<s;n++)t[r+n]=(e&255<<8*(a?n:1-n))>>>8*(a?n:1-n)}function v(t,e,r,a){e<0&&(e=4294967295+e+1);for(var n=0,s=Math.min(t.length-r,4);n<s;n++)t[r+n]=e>>>8*(a?n:3-n)&255}function w(t,e,r,a,n,s){if(e>n||e<s)throw new RangeError("value is out of bounds");if(r+a>t.length)throw new RangeError("index out of range");if(r<0)throw new RangeError("index out of range")}function S(t,e,r,a,n){return n||w(t,e,r,4,3.4028234663852886e38,-3.4028234663852886e38),N.write(t,e,r,a,23,4),r+4}function A(t,e,r,a,n){return n||w(t,e,r,8,1.7976931348623157e308,-1.7976931348623157e308),N.write(t,e,r,a,52,8),r+8}function P(t){if(t=I(t).replace(q,""),t.length<2)return"";for(;t.length%4!==0;)t+="=";return t}function I(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function M(t){return V(t)||a.isBuffer(t)||t&&"object"==typeof t&&"number"==typeof t.length}function E(t){return t<16?"0"+t.toString(16):t.toString(16)}function T(t,e){e=e||1/0;for(var r,a=t.length,n=null,s=[],i=0;i<a;i++){if(r=t.charCodeAt(i),r>55295&&r<57344){if(!n){if(r>56319){(e-=3)>-1&&s.push(239,191,189);continue}if(i+1===a){(e-=3)>-1&&s.push(239,191,189);continue}n=r;continue}if(r<56320){(e-=3)>-1&&s.push(239,191,189),n=r;continue}r=n-55296<<10|r-56320|65536,n=null}else n&&((e-=3)>-1&&s.push(239,191,189),n=null);if(r<128){if((e-=1)<0)break;s.push(r)}else if(r<2048){if((e-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<2097152))throw new Error("Invalid code point");if((e-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return s}function F(t){for(var e=[],r=0;r<t.length;r++)e.push(255&t.charCodeAt(r));return e}function D(t,e){for(var r,a,n,s=[],i=0;i<t.length&&!((e-=2)<0);i++)r=t.charCodeAt(i),a=r>>8,n=r%256,s.push(n),s.push(a);return s}function R(t){return O.toByteArray(P(t))}function L(t,e,r,a){for(var n=0;n<a&&!(n+r>=e.length||n>=t.length);n++)e[n+r]=t[n];return n}function B(t){try{return decodeURIComponent(t)}catch(t){return String.fromCharCode(65533)}}var O=t("base64-js"),N=t("ieee754"),V=t("is-array");r.Buffer=a,r.SlowBuffer=n,r.INSPECT_MAX_BYTES=50,a.poolSize=8192;var j=1073741823,x={};a.TYPED_ARRAY_SUPPORT=function(){try{var t=new ArrayBuffer(0),e=new Uint8Array(t);return e.foo=function(){return 42},42===e.foo()&&"function"==typeof e.subarray&&0===new Uint8Array(1).subarray(1,1).byteLength}catch(t){return!1}}(),a.isBuffer=function(t){return!(null==t||!t._isBuffer)},a.compare=function(t,e){if(!a.isBuffer(t)||!a.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var r=t.length,n=e.length,s=0,i=Math.min(r,n);s<i&&t[s]===e[s];s++);return s!==i&&(r=t[s],n=e[s]),r<n?-1:n<r?1:0},a.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(t,e){if(!V(t))throw new TypeError("list argument must be an Array of Buffers.");if(0===t.length)return new a(0);if(1===t.length)return t[0];var r;if(void 0===e)for(e=0,r=0;r<t.length;r++)e+=t[r].length;var n=new a(e),s=0;for(r=0;r<t.length;r++){var i=t[r];i.copy(n,s),s+=i.length}return n},a.byteLength=function(t,e){var r;switch(t+="",e||"utf8"){case"ascii":case"binary":case"raw":r=t.length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":r=2*t.length;break;case"hex":r=t.length>>>1;break;case"utf8":case"utf-8":r=T(t).length;break;case"base64":r=R(t).length;break;default:r=t.length}return r},a.prototype.length=void 0,a.prototype.parent=void 0,a.prototype.toString=function(t,e,r){var a=!1;if(e>>>=0,r=void 0===r||r===1/0?this.length:r>>>0,t||(t="utf8"),e<0&&(e=0),r>this.length&&(r=this.length),r<=e)return"";for(;;)switch(t){case"hex":return y(this,e,r);case"utf8":case"utf-8":return c(this,e,r);case"ascii":return p(this,e,r);case"binary":return d(this,e,r);case"base64":return f(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return g(this,e,r);default:if(a)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),a=!0}},a.prototype.equals=function(t){if(!a.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===a.compare(this,t)},a.prototype.inspect=function(){var t="",e=r.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(t+=" ... ")),"<Buffer "+t+">"},a.prototype.compare=function(t){if(!a.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t?0:a.compare(this,t)},a.prototype.indexOf=function(t,e){function r(t,e,r){for(var a=-1,n=0;r+n<t.length;n++)if(t[r+n]===e[a===-1?0:n-a]){if(a===-1&&(a=n),n-a+1===e.length)return r+a}else a=-1;return-1}if(e>2147483647?e=2147483647:e<-2147483648&&(e=-2147483648),e>>=0,0===this.length)return-1;if(e>=this.length)return-1;if(e<0&&(e=Math.max(this.length+e,0)),"string"==typeof t)return 0===t.length?-1:String.prototype.indexOf.call(this,t,e);if(a.isBuffer(t))return r(this,t,e);if("number"==typeof t)return a.TYPED_ARRAY_SUPPORT&&"function"===Uint8Array.prototype.indexOf?Uint8Array.prototype.indexOf.call(this,t,e):r(this,[t],e);throw new TypeError("val must be string, number or Buffer")},a.prototype.get=function(t){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(t)},a.prototype.set=function(t,e){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(t,e)},a.prototype.write=function(t,e,r,a){if(isFinite(e))isFinite(r)||(a=r,r=void 0);else{var n=a;a=e,e=r,r=n}if(e=Number(e)||0,r<0||e<0||e>this.length)throw new RangeError("attempt to write outside buffer bounds");var f=this.length-e;r?(r=Number(r),r>f&&(r=f)):r=f,a=String(a||"utf8").toLowerCase();var c;switch(a){case"hex":c=s(this,t,e,r);break;case"utf8":case"utf-8":c=i(this,t,e,r);break;case"ascii":c=o(this,t,e,r);break;case"binary":c=h(this,t,e,r);break;case"base64":c=u(this,t,e,r);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":c=l(this,t,e,r);break;default:throw new TypeError("Unknown encoding: "+a)}return c},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},a.prototype.slice=function(t,e){var r=this.length;t=~~t,e=void 0===e?r:~~e,t<0?(t+=r,t<0&&(t=0)):t>r&&(t=r),e<0?(e+=r,e<0&&(e=0)):e>r&&(e=r),e<t&&(e=t);var n;if(a.TYPED_ARRAY_SUPPORT)n=a._augment(this.subarray(t,e));else{var s=e-t;n=new a(s,void 0);for(var i=0;i<s;i++)n[i]=this[i+t]}return n.length&&(n.parent=this.parent||this),n},a.prototype.readUIntLE=function(t,e,r){t>>>=0,e>>>=0,r||_(t,e,this.length);for(var a=this[t],n=1,s=0;++s<e&&(n*=256);)a+=this[t+s]*n;return a},a.prototype.readUIntBE=function(t,e,r){t>>>=0,e>>>=0,r||_(t,e,this.length);for(var a=this[t+--e],n=1;e>0&&(n*=256);)a+=this[t+--e]*n;return a},a.prototype.readUInt8=function(t,e){return e||_(t,1,this.length),this[t]},a.prototype.readUInt16LE=function(t,e){return e||_(t,2,this.length),this[t]|this[t+1]<<8},a.prototype.readUInt16BE=function(t,e){return e||_(t,2,this.length),this[t]<<8|this[t+1]},a.prototype.readUInt32LE=function(t,e){return e||_(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},a.prototype.readUInt32BE=function(t,e){return e||_(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},a.prototype.readIntLE=function(t,e,r){t>>>=0,e>>>=0,r||_(t,e,this.length);for(var a=this[t],n=1,s=0;++s<e&&(n*=256);)a+=this[t+s]*n;return n*=128,a>=n&&(a-=Math.pow(2,8*e)),a},a.prototype.readIntBE=function(t,e,r){t>>>=0,e>>>=0,r||_(t,e,this.length);for(var a=e,n=1,s=this[t+--a];a>0&&(n*=256);)s+=this[t+--a]*n;return n*=128,s>=n&&(s-=Math.pow(2,8*e)),s},a.prototype.readInt8=function(t,e){return e||_(t,1,this.length),128&this[t]?(255-this[t]+1)*-1:this[t]},a.prototype.readInt16LE=function(t,e){e||_(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},a.prototype.readInt16BE=function(t,e){e||_(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},a.prototype.readInt32LE=function(t,e){return e||_(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},a.prototype.readInt32BE=function(t,e){return e||_(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},a.prototype.readFloatLE=function(t,e){return e||_(t,4,this.length),N.read(this,t,!0,23,4)},a.prototype.readFloatBE=function(t,e){return e||_(t,4,this.length),N.read(this,t,!1,23,4)},a.prototype.readDoubleLE=function(t,e){return e||_(t,8,this.length),N.read(this,t,!0,52,8)},a.prototype.readDoubleBE=function(t,e){return e||_(t,8,this.length),N.read(this,t,!1,52,8)},a.prototype.writeUIntLE=function(t,e,r,a){t=+t,e>>>=0,r>>>=0,a||m(this,t,e,r,Math.pow(2,8*r),0);var n=1,s=0;for(this[e]=255&t;++s<r&&(n*=256);)this[e+s]=t/n>>>0&255;return e+r},a.prototype.writeUIntBE=function(t,e,r,a){t=+t,e>>>=0,r>>>=0,a||m(this,t,e,r,Math.pow(2,8*r),0);var n=r-1,s=1;for(this[e+n]=255&t;--n>=0&&(s*=256);)this[e+n]=t/s>>>0&255;return e+r},a.prototype.writeUInt8=function(t,e,r){return t=+t,e>>>=0,r||m(this,t,e,1,255,0),a.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=t,e+1},a.prototype.writeUInt16LE=function(t,e,r){return t=+t,e>>>=0,r||m(this,t,e,2,65535,0),a.TYPED_ARRAY_SUPPORT?(this[e]=t,this[e+1]=t>>>8):b(this,t,e,!0),e+2},a.prototype.writeUInt16BE=function(t,e,r){return t=+t,e>>>=0,r||m(this,t,e,2,65535,0),a.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=t):b(this,t,e,!1),e+2},a.prototype.writeUInt32LE=function(t,e,r){return t=+t,e>>>=0,r||m(this,t,e,4,4294967295,0),a.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=t):v(this,t,e,!0),e+4},a.prototype.writeUInt32BE=function(t,e,r){
return t=+t,e>>>=0,r||m(this,t,e,4,4294967295,0),a.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t):v(this,t,e,!1),e+4},a.prototype.writeIntLE=function(t,e,r,a){t=+t,e>>>=0,a||m(this,t,e,r,Math.pow(2,8*r-1)-1,-Math.pow(2,8*r-1));var n=0,s=1,i=t<0?1:0;for(this[e]=255&t;++n<r&&(s*=256);)this[e+n]=(t/s>>0)-i&255;return e+r},a.prototype.writeIntBE=function(t,e,r,a){t=+t,e>>>=0,a||m(this,t,e,r,Math.pow(2,8*r-1)-1,-Math.pow(2,8*r-1));var n=r-1,s=1,i=t<0?1:0;for(this[e+n]=255&t;--n>=0&&(s*=256);)this[e+n]=(t/s>>0)-i&255;return e+r},a.prototype.writeInt8=function(t,e,r){return t=+t,e>>>=0,r||m(this,t,e,1,127,-128),a.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=t,e+1},a.prototype.writeInt16LE=function(t,e,r){return t=+t,e>>>=0,r||m(this,t,e,2,32767,-32768),a.TYPED_ARRAY_SUPPORT?(this[e]=t,this[e+1]=t>>>8):b(this,t,e,!0),e+2},a.prototype.writeInt16BE=function(t,e,r){return t=+t,e>>>=0,r||m(this,t,e,2,32767,-32768),a.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=t):b(this,t,e,!1),e+2},a.prototype.writeInt32LE=function(t,e,r){return t=+t,e>>>=0,r||m(this,t,e,4,2147483647,-2147483648),a.TYPED_ARRAY_SUPPORT?(this[e]=t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):v(this,t,e,!0),e+4},a.prototype.writeInt32BE=function(t,e,r){return t=+t,e>>>=0,r||m(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),a.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t):v(this,t,e,!1),e+4},a.prototype.writeFloatLE=function(t,e,r){return S(this,t,e,!0,r)},a.prototype.writeFloatBE=function(t,e,r){return S(this,t,e,!1,r)},a.prototype.writeDoubleLE=function(t,e,r){return A(this,t,e,!0,r)},a.prototype.writeDoubleBE=function(t,e,r){return A(this,t,e,!1,r)},a.prototype.copy=function(t,e,r,n){if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);var s=n-r;if(s<1e3||!a.TYPED_ARRAY_SUPPORT)for(var i=0;i<s;i++)t[i+e]=this[i+r];else t._set(this.subarray(r,r+s),e);return s},a.prototype.fill=function(t,e,r){if(t||(t=0),e||(e=0),r||(r=this.length),r<e)throw new RangeError("end < start");if(r!==e&&0!==this.length){if(e<0||e>=this.length)throw new RangeError("start out of bounds");if(r<0||r>this.length)throw new RangeError("end out of bounds");var a;if("number"==typeof t)for(a=e;a<r;a++)this[a]=t;else{var n=T(t.toString()),s=n.length;for(a=e;a<r;a++)this[a]=n[a%s]}return this}},a.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(a.TYPED_ARRAY_SUPPORT)return new a(this).buffer;for(var t=new Uint8Array(this.length),e=0,r=t.length;e<r;e+=1)t[e]=this[e];return t.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser")};var U=a.prototype;a._augment=function(t){return t.constructor=a,t._isBuffer=!0,t._set=t.set,t.get=U.get,t.set=U.set,t.write=U.write,t.toString=U.toString,t.toLocaleString=U.toString,t.toJSON=U.toJSON,t.equals=U.equals,t.compare=U.compare,t.indexOf=U.indexOf,t.copy=U.copy,t.slice=U.slice,t.readUIntLE=U.readUIntLE,t.readUIntBE=U.readUIntBE,t.readUInt8=U.readUInt8,t.readUInt16LE=U.readUInt16LE,t.readUInt16BE=U.readUInt16BE,t.readUInt32LE=U.readUInt32LE,t.readUInt32BE=U.readUInt32BE,t.readIntLE=U.readIntLE,t.readIntBE=U.readIntBE,t.readInt8=U.readInt8,t.readInt16LE=U.readInt16LE,t.readInt16BE=U.readInt16BE,t.readInt32LE=U.readInt32LE,t.readInt32BE=U.readInt32BE,t.readFloatLE=U.readFloatLE,t.readFloatBE=U.readFloatBE,t.readDoubleLE=U.readDoubleLE,t.readDoubleBE=U.readDoubleBE,t.writeUInt8=U.writeUInt8,t.writeUIntLE=U.writeUIntLE,t.writeUIntBE=U.writeUIntBE,t.writeUInt16LE=U.writeUInt16LE,t.writeUInt16BE=U.writeUInt16BE,t.writeUInt32LE=U.writeUInt32LE,t.writeUInt32BE=U.writeUInt32BE,t.writeIntLE=U.writeIntLE,t.writeIntBE=U.writeIntBE,t.writeInt8=U.writeInt8,t.writeInt16LE=U.writeInt16LE,t.writeInt16BE=U.writeInt16BE,t.writeInt32LE=U.writeInt32LE,t.writeInt32BE=U.writeInt32BE,t.writeFloatLE=U.writeFloatLE,t.writeFloatBE=U.writeFloatBE,t.writeDoubleLE=U.writeDoubleLE,t.writeDoubleBE=U.writeDoubleBE,t.fill=U.fill,t.inspect=U.inspect,t.toArrayBuffer=U.toArrayBuffer,t};var q=/[^+\/0-9A-z\-]/g},{"base64-js":12,ieee754:13,"is-array":14}],12:[function(t,e,r){var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(t){"use strict";function e(t){var e=t.charCodeAt(0);return e===i||e===f?62:e===o||e===c?63:e<h?-1:e<h+10?e-h+26+26:e<l+26?e-l:e<u+26?e-u+26:void 0}function r(t){function r(t){u[f++]=t}var a,n,i,o,h,u;if(t.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var l=t.length;h="="===t.charAt(l-2)?2:"="===t.charAt(l-1)?1:0,u=new s(3*t.length/4-h),i=h>0?t.length-4:t.length;var f=0;for(a=0,n=0;a<i;a+=4,n+=3)o=e(t.charAt(a))<<18|e(t.charAt(a+1))<<12|e(t.charAt(a+2))<<6|e(t.charAt(a+3)),r((16711680&o)>>16),r((65280&o)>>8),r(255&o);return 2===h?(o=e(t.charAt(a))<<2|e(t.charAt(a+1))>>4,r(255&o)):1===h&&(o=e(t.charAt(a))<<10|e(t.charAt(a+1))<<4|e(t.charAt(a+2))>>2,r(o>>8&255),r(255&o)),u}function n(t){function e(t){return a.charAt(t)}function r(t){return e(t>>18&63)+e(t>>12&63)+e(t>>6&63)+e(63&t)}var n,s,i,o=t.length%3,h="";for(n=0,i=t.length-o;n<i;n+=3)s=(t[n]<<16)+(t[n+1]<<8)+t[n+2],h+=r(s);switch(o){case 1:s=t[t.length-1],h+=e(s>>2),h+=e(s<<4&63),h+="==";break;case 2:s=(t[t.length-2]<<8)+t[t.length-1],h+=e(s>>10),h+=e(s>>4&63),h+=e(s<<2&63),h+="="}return h}var s="undefined"!=typeof Uint8Array?Uint8Array:Array,i="+".charCodeAt(0),o="/".charCodeAt(0),h="0".charCodeAt(0),u="a".charCodeAt(0),l="A".charCodeAt(0),f="-".charCodeAt(0),c="_".charCodeAt(0);t.toByteArray=r,t.fromByteArray=n}("undefined"==typeof r?this.base64js={}:r)},{}],13:[function(t,e,r){r.read=function(t,e,r,a,n){var s,i,o=8*n-a-1,h=(1<<o)-1,u=h>>1,l=-7,f=r?n-1:0,c=r?-1:1,p=t[e+f];for(f+=c,s=p&(1<<-l)-1,p>>=-l,l+=o;l>0;s=256*s+t[e+f],f+=c,l-=8);for(i=s&(1<<-l)-1,s>>=-l,l+=a;l>0;i=256*i+t[e+f],f+=c,l-=8);if(0===s)s=1-u;else{if(s===h)return i?NaN:(p?-1:1)*(1/0);i+=Math.pow(2,a),s-=u}return(p?-1:1)*i*Math.pow(2,s-a)},r.write=function(t,e,r,a,n,s){var i,o,h,u=8*s-n-1,l=(1<<u)-1,f=l>>1,c=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,p=a?0:s-1,d=a?1:-1,y=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(o=isNaN(e)?1:0,i=l):(i=Math.floor(Math.log(e)/Math.LN2),e*(h=Math.pow(2,-i))<1&&(i--,h*=2),e+=i+f>=1?c/h:c*Math.pow(2,1-f),e*h>=2&&(i++,h/=2),i+f>=l?(o=0,i=l):i+f>=1?(o=(e*h-1)*Math.pow(2,n),i+=f):(o=e*Math.pow(2,f-1)*Math.pow(2,n),i=0));n>=8;t[r+p]=255&o,p+=d,o/=256,n-=8);for(i=i<<n|o,u+=n;u>0;t[r+p]=255&i,p+=d,i/=256,u-=8);t[r+p-d]|=128*y}},{}],14:[function(t,e,r){var a=Array.isArray,n=Object.prototype.toString;e.exports=a||function(t){return!!t&&"[object Array]"==n.call(t)}},{}],"ndarray-fft":[function(t,e,r){"use strict";function a(t,e,r){var a,h,u=e.shape,l=u.length,f=1,c=new Array(l),p=0;for(a=l-1;a>=0;--a)if(c[a]=f,f*=u[a],p=Math.max(p,o.scratchMemory(u[a])),e.shape[a]!==r.shape[a])throw new Error("Shape mismatch, real and imaginary arrays must have same size");var d,y=4*f+p;d="array"===e.dtype||"float64"===e.dtype||"custom"===e.dtype?i.mallocDouble(y):i.mallocFloat(y);var g,_,m,b,v=s(d,u.slice(0),c,0),w=s(d,u.slice(0),c.slice(0),f),S=s(d,u.slice(0),c.slice(0),2*f),A=s(d,u.slice(0),c.slice(0),3*f),P=4*f;for(n.assign(v,e),n.assign(w,r),a=l-1;a>=0&&(o(t,f/u[a],u[a],d,v.offset,w.offset,P),0!==a);--a){for(_=1,m=S.stride,b=A.stride,h=a-1;h<l;++h)b[h]=m[h]=_,_*=u[h];for(h=a-2;h>=0;--h)b[h]=m[h]=_,_*=u[h];n.assign(S,v),n.assign(A,w),g=v,v=S,S=g,g=w,w=A,A=g}n.assign(e,v),n.assign(r,w),i.free(d)}var n=t("ndarray-ops"),s=t("ndarray"),i=t("typedarray-pool"),o=t("./lib/fft-matrix.js");e.exports=a},{"./lib/fft-matrix.js":1,ndarray:"ndarray","ndarray-ops":3,"typedarray-pool":9}],ndarray:[function(t,e,r){(function(r){function a(t,e){return t[0]-e[0]}function n(){var t,e=this.stride,r=new Array(e.length);for(t=0;t<r.length;++t)r[t]=[Math.abs(e[t]),t];r.sort(a);var n=new Array(r.length);for(t=0;t<n.length;++t)n[t]=r[t][1];return n}function s(t,e){var r=["View",e,"d",t].join("");e<0&&(r="View_Nil"+t);var a="generic"===t;if(e===-1){var s="function "+r+"(a){this.data=a;};var proto="+r+".prototype;proto.dtype='"+t+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+r+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+r+"(a){return new "+r+"(a);}",i=new Function(s);return i()}if(0===e){var s="function "+r+"(a,d) {this.data = a;this.offset = d};var proto="+r+".prototype;proto.dtype='"+t+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+r+"_copy() {return new "+r+"(this.data,this.offset)};proto.pick=function "+r+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+r+"_get(){return "+(a?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+r+"_set(v){return "+(a?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+r+"(a,b,c,d){return new "+r+"(a,d)}",i=new Function("TrivialArray",s);return i(f[t][0])}var s=["'use strict'"],o=h(e),u=o.map(function(t){return"i"+t}),l="this.offset+"+o.map(function(t){return"this.stride["+t+"]*i"+t}).join("+"),c=o.map(function(t){return"b"+t}).join(","),p=o.map(function(t){return"c"+t}).join(",");s.push("function "+r+"(a,"+c+","+p+",d){this.data=a","this.shape=["+c+"]","this.stride=["+p+"]","this.offset=d|0}","var proto="+r+".prototype","proto.dtype='"+t+"'","proto.dimension="+e),s.push("Object.defineProperty(proto,'size',{get:function "+r+"_size(){return "+o.map(function(t){return"this.shape["+t+"]"}).join("*"),"}})"),1===e?s.push("proto.order=[0]"):(s.push("Object.defineProperty(proto,'order',{get:"),e<4?(s.push("function "+r+"_order(){"),2===e?s.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===e&&s.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):s.push("ORDER})")),s.push("proto.set=function "+r+"_set("+u.join(",")+",v){"),a?s.push("return this.data.set("+l+",v)}"):s.push("return this.data["+l+"]=v}"),s.push("proto.get=function "+r+"_get("+u.join(",")+"){"),a?s.push("return this.data.get("+l+")}"):s.push("return this.data["+l+"]}"),s.push("proto.index=function "+r+"_index(",u.join(),"){return "+l+"}"),s.push("proto.hi=function "+r+"_hi("+u.join(",")+"){return new "+r+"(this.data,"+o.map(function(t){return["(typeof i",t,"!=='number'||i",t,"<0)?this.shape[",t,"]:i",t,"|0"].join("")}).join(",")+","+o.map(function(t){return"this.stride["+t+"]"}).join(",")+",this.offset)}");var d=o.map(function(t){return"a"+t+"=this.shape["+t+"]"}),y=o.map(function(t){return"c"+t+"=this.stride["+t+"]"});s.push("proto.lo=function "+r+"_lo("+u.join(",")+"){var b=this.offset,d=0,"+d.join(",")+","+y.join(","));for(var g=0;g<e;++g)s.push("if(typeof i"+g+"==='number'&&i"+g+">=0){d=i"+g+"|0;b+=c"+g+"*d;a"+g+"-=d}");s.push("return new "+r+"(this.data,"+o.map(function(t){return"a"+t}).join(",")+","+o.map(function(t){return"c"+t}).join(",")+",b)}"),s.push("proto.step=function "+r+"_step("+u.join(",")+"){var "+o.map(function(t){return"a"+t+"=this.shape["+t+"]"}).join(",")+","+o.map(function(t){return"b"+t+"=this.stride["+t+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(var g=0;g<e;++g)s.push("if(typeof i"+g+"==='number'){d=i"+g+"|0;if(d<0){c+=b"+g+"*(a"+g+"-1);a"+g+"=ceil(-a"+g+"/d)}else{a"+g+"=ceil(a"+g+"/d)}b"+g+"*=d}");s.push("return new "+r+"(this.data,"+o.map(function(t){return"a"+t}).join(",")+","+o.map(function(t){return"b"+t}).join(",")+",c)}");for(var _=new Array(e),m=new Array(e),g=0;g<e;++g)_[g]="a[i"+g+"]",m[g]="b[i"+g+"]";s.push("proto.transpose=function "+r+"_transpose("+u+"){"+u.map(function(t,e){return t+"=("+t+"===undefined?"+e+":"+t+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+r+"(this.data,"+_.join(",")+","+m.join(",")+",this.offset)}"),s.push("proto.pick=function "+r+"_pick("+u+"){var a=[],b=[],c=this.offset");for(var g=0;g<e;++g)s.push("if(typeof i"+g+"==='number'&&i"+g+">=0){c=(c+this.stride["+g+"]*i"+g+")|0}else{a.push(this.shape["+g+"]);b.push(this.stride["+g+"])}");s.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),s.push("return function construct_"+r+"(data,shape,stride,offset){return new "+r+"(data,"+o.map(function(t){return"shape["+t+"]"}).join(",")+","+o.map(function(t){return"stride["+t+"]"}).join(",")+",offset)}");var i=new Function("CTOR_LIST","ORDER",s.join("\n"));return i(f[t],n)}function i(t){if(l&&r.isBuffer(t))return"buffer";if(u)switch(Object.prototype.toString.call(t)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped"}return Array.isArray(t)?"array":"generic"}function o(t,e,r,a){if(void 0===t){var n=f.array[0];return n([])}"number"==typeof t&&(t=[t]),void 0===e&&(e=[t.length]);var o=e.length;if(void 0===r){r=new Array(o);for(var h=o-1,u=1;h>=0;--h)r[h]=u,u*=e[h]}if(void 0===a){a=0;for(var h=0;h<o;++h)r[h]<0&&(a-=(e[h]-1)*r[h])}for(var l=i(t),c=f[l];c.length<=o+1;)c.push(s(l,c.length-1));var n=c[o+1];return n(t,e,r,a)}var h=t("iota-array"),u="undefined"!=typeof Float64Array,l="undefined"!=typeof r,f={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]};e.exports=o}).call(this,t("buffer").Buffer)},{buffer:11,"iota-array":10}]},{},[]);var ndarray=require("ndarray"),ndarray_fft=require("ndarray-fft");Math.sinc=function(t){return Math.sin(Math.PI*t)/(Math.PI*t)},Math.bessi0=function(t){var e=Math.abs(t);return e<3.75?(y=t/3.75,y*=y,1+y*(3.5156229+y*(3.0899424+y*(1.2067492+y*(.2659732+y*(.0360768+.0045813*y)))))):(y=3.75/e,Math.exp(e)/Math.sqrt(e)*(.39894228+y*(.01328592+y*(.00225319+y*(-.00157565+y*(.00916281+y*(-.02057706+y*(.02635537+y*(-.01647633+.00392377*y)))))))))};var STFT=new function(){var t=null,e=null,r=function(t,e){return 2/t*(t/2-Math.abs(e-(t-1)/2))},a=function(t,e){return.5*(1-Math.cos(2*Math.PI*e/(t-1)))},n=function(t,e){return.54-.46*Math.cos(2*Math.PI*e/(t-1))},s=function(t,e){return 2/(t-1)*((t-1)/2-Math.abs(e-(t-1)/2))},i=function(t,e){return.62-.48*Math.abs(e/(t-1)-.5)-.38*Math.cos(2*Math.PI*e/(t-1))},o=function(t,e,r){var a=(1-r)/2,n=.5,s=r/2;return a-n*Math.cos(DSP.TWO_PI*e/(t-1))+s*Math.cos(4*Math.PI*e/(t-1))},h=function(t,e){return Math.cos(Math.PI*e/(t-1)-Math.PI/2)},u=function(t,e,r){return Math.pow(Math.E,-.5*Math.pow((e-(t-1)/2)/(r*(t-1)/2),2))},l=function(t,e){var r=2*e/(t-1)-1;return Math.sin(Math.PI*r)/(Math.PI*r)},f=function(t,e){return 1},c=function(t,e){return 2*a(t,e)/3},p=function(t,e,r){return r||(r=3),Math.bessi0(Math.PI*r*Math.sqrt(1-Math.pow(2*e/(t-1)-1,2)))/Math.bessi0(Math.PI*r)},d=function(t,e){return.355768-.487396*Math.cos(2*Math.PI*e/(t-1))+.144232*Math.cos(4*Math.PI*e/(t-1))-.012604*Math.cos(6*Math.PI*e/(t-1))},y=function(t,e){return 1-1.93*Math.cos(2*Math.PI*e/(t-1))+1.29*Math.cos(4*Math.PI*e/(t-1))-.388*Math.cos(6*Math.PI*e/(t-1))+.032*Math.cos(8*Math.PI*e/(t-1))},g=function(t){return"hann"===t?a:"triangular"===t?r:"hamming"===t?n:"bartlett"===t?s:"bartlettHann"===t?i:"blackman"===t?o:"cosine"===t?h:"gauss"===t?u:"lanczos"===t?l:"rectangular"===t?f:"kaiser"===t?p:"nutall"===t?d:"flattop"===t?y:a};this.initializeForwardWindow=function(e,r,a){t=new Float32Array(e),void 0===a&&(a=.16);var n=0,s=null;for(s="function"==typeof type?r:g(r),n=0;n<e;n+=1)t[n]=s(e,n,a)},this.initializeInverseWindow=function(t,r){e=new Float32Array(t);var a=0,n=c;for(a=0;a<t;a+=1)e[a]=n(a/(t-1))},this.forward=function(e,r,a){var a=a||e>>>2,n=new Float32Array(2*e),s=new Float32Array(e),i=new Float32Array(e),o=0,h=t,u=ndarray(s),l=ndarray(i);return function(t){var f,c,p,d=e,y=h,g=n,_=s,m=i;for(g.set(t,o),o+=d,c=0;c+d<=o;c+=a){for(f=0;f<d;++f)_[f]=g[f+c]*y[f];for(f=0;f<d;++f)m[f]=0;ndarray_fft(1,u,l),r(_,m)}for(p=o,f=0;c<p;++f,++c)g[f]=g[c];o=f}},this.inverse=function(t,r,a){var a=a||t>>>2,n=new Float32Array(2*t),s=n.subarray(0,t),i=0,o=0,h=e,u=ndarray(h),l=ndarray(h);return function(e,f){var c,p,d,y=t,g=h,_=n;for(u.data=e,l.data=f,ndarray_fft(-1,u,l),d=o,c=0,p=i;p<d;++c,++p)_[p]+=g[c]*e[c];for(;c<y;++c,++p)_[p]=g[c]*e[c];for(i+=a,o=p;i>=y;){for(r(s),c=0,p=y;c<y;++c,++p)_[c]=_[p];o-=y,i-=y}}}},_fs_palette={0:[0,0,0],10:[75,0,159],20:[104,0,251],30:[131,0,255],40:[155,18,157],50:[175,37,0],60:[191,59,0],70:[206,88,0],80:[223,132,0],90:[240,188,0],100:[255,252,0]},_midi_notes_map=[],_notes_name=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],_spectrum_colors=[],_hzToMIDINote=function(t){return 69+12*Math.log2(t/440)},_hzToOscillator=function(t,e,r,a){return a-Math.log(t/e)/Math.log(2)*Math.floor(a/r+.5)},_MIDINoteName=function(t){return _midi_notes_map[Math.round(t)]},_randomInt=function(t,e){return Math.floor(Math.random()*(e-t+1)+t)},_random=function(t,e){return Math.random()*(e-t)+t},_webMIDISupport=function(){return!!navigator.requestMIDIAccess},_objSwap=function(t,e){var r=null,a=null;for(r in t)a=e[r],e[r]=t[r],t[r]=a},cloneObj=function(t){return JSON.parse(JSON.stringify(t))},_swapArrayItem=function(t,e,r){var a=t[e];return t[e]=t[r],t[r]=a,t},_isPowerOf2=function(t){return 0===(t&t-1)},_parseInt10=function(t){return parseInt(t,10)},_getElementOffset=function(t){var e=t.getBoundingClientRect(),r=document.body,a=document.documentElement,n=window.pageYOffset||a.scrollTop||r.scrollTop,s=window.pageXOffset||a.scrollLeft||r.scrollLeft,i=a.clientTop||r.clientTop||0,o=a.clientLeft||r.clientLeft||0,h=e.top+n-i,u=e.left+s-o;return{top:Math.round(h),left:Math.round(u),width:e.width,height:e.height}},_getFundamentalFrequency=function(t,e,r,a){var n=0,s=0,i=0,o=1/0;for(n=r-1;n>=0;n-=1)for(s=0;s<e;s+=1)i=n*(4*e)+4*s,a?t[i+3]>0&&(o=Math.min(o,_getFrequency(n))):(t[i]+t[i+1])/2>0&&(o=Math.min(o,_getFrequency(n)));return o},_getSonogramBoundary=function(t,e,r,a,n){var s=0,i=0,o=0,h=e,u=0,l=Math.min,f=0;for(n&&(f=-(e-1),l=Math.max,h=0),s=r-1;s>=0;s-=1)for(i=0;i<e;i+=1)if(u=Math.abs(i+f),o=s*(4*e)+4*u,a){if(t[o+3]>0){h=l(h,u);break}}else if(t[o]>0||t[o+1]>0){h=l(h,u);break}return h},_xhrContent=function(t,e){var r=new XMLHttpRequest;r.open("GET",t,!0),r.onreadystatechange=function(){4==r.readyState&&200==r.status&&e(r.responseText)},r.send()},_rgbToHex=function(t,e,r){return((1<<24)+(t<<16)+(e<<8)+r).toString(16).slice(1)},_decimalToHTMLColor=function(t){return("00000"+(0|t).toString(16)).substr(-6)},_logScale=function(t,e,r){var a=r||2,n=Math.log(e+1)/Math.log(a),s=n*t/e;return Math.round(Math.pow(a,s)-1)},_melScale=function(){},_degToRad=function(t){return t*Math.PI/180},_swapNode=function(t,e){if(t&&e){var r,a,n=t.parentNode,s=document.createElement("span");n.insertBefore(s,t),r=e.parentNode,a=document.createElement("span"),r.insertBefore(a,e),n.insertBefore(e,s),r.insertBefore(t,a),n.removeChild(s),r.removeChild(a)}},_setImageSmoothing=function(t,e){t&&(t.mozImageSmoothingEnabled=e,t.oImageSmoothingEnabled=e,t.msImageSmoothingEnabled=e,t.imageSmoothingEnabled=e)},_barkScale=function(t,e,r){var a=new Float32Array(t),n=0;for(n=0;n<a.length;n+=1)a[n]=n*e/r,a[n]=13*Math.atan(a[n]/1315.8)+3.5*Math.atan(Math.pow(a[n]/7518,2));return a},_getColorFromPalette=function(t){var e,r,a=100*t/255,n=10*Math.floor(a/10),s=a-n,i=s/10;return e=a<100?[_fs_palette[n+10][0]-_fs_palette[n+10][0],_fs_palette[n+10][1]-_fs_palette[n+10][1],_fs_palette[n+10][2]-_fs_palette[n+10][2]]:[0,0,0],r=[_fs_palette[n][0]+i*e[0],_fs_palette[n][1]+i*e[1],_fs_palette[n][2]+i*e[2]],"rgb("+r[0]+", "+r[1]+","+r[2]+")"},_truncateDecimals=function(t,e){var r=(+t).toFixed(e+1);return+r.slice(0,r.length-1)},_clipboardCopy=function(t){var e=new ClipboardEvent("copy",{dataType:"text/plain",data:t.target.dataset.clipboard});document.dispatchEvent(e)},_isFireFox=function(){return navigator.userAgent.toLowerCase().indexOf("firefox")>-1},_frequencyFromNoteNumber=function(t){return 440*Math.pow(2,(t-69)/12)},_getNoteTime=function(t,e){return 1/e*(60/t)},_lZeroPad=function(t,e,r){for(t=""+t;t.length<r;)t=e+t;return t},_setCookie=function(t,e,r){var a=new Date;a.setTime(a.getTime()+24*r*60*60*1e3),document.cookie=t+"="+e+";expires="+a.toUTCString()+";path=/"},_getCookie=function(t){var e,r,a=0;for(t+="=",e=document.cookie.split(";"),a=0;a<e.length;a+=1){for(r=e[a];" "==r.charAt(0);)r=r.substring(1);if(0===r.indexOf(t))return r.substring(t.length,r.length)}return""},_fnToImageData=function(t,e){return function(){var r,a=document.createElement("canvas"),n=a.getContext("2d");a.width=t.naturalWidth,a.height=t.naturalHeight,n.drawImage(t,0,0,a.width,a.height),r=n.getImageData(0,0,a.width,a.height),e(r)}},_fnCanvasToImage=function(t,e){var r=document.createElement("img");r.src=t.toDataURL(),r.width=t.width,r.height=t.height,r.onload=function(){r.onload=null,e(r)}},_fnFlipImage=function(t,e){return function(){var r,a=document.createElement("canvas"),n=a.getContext("2d");a.width=t.naturalWidth,a.height=t.naturalHeight,n.translate(0,a.height),n.scale(1,-1),n.drawImage(t,0,0,a.width,a.height),r=n.getImageData(0,0,a.width,a.height),e({canvas:a,image_data:r})}},_flipImage=function(t,e){_fnFlipImage(t,e)()},_toolsInit=function(){var t,e,r,a=0;for(a=0;a<256;a+=1)_spectrum_colors.push(_getColorFromPalette(a));for(a=0;a<127;a+=1)t=a,e=_notes_name[t%12],r=(t/12|0)-1,e+=r,_midi_notes_map[a]=e};_toolsInit();var logScale=function(t,e,r){var a=r||2,n=Math.log(e+1)/Math.log(a),s=n*t/e;return Math.pow(a,s)-1},_progress=0,_prev_progress=0,_stereo=!1,_convert=function(t,e){var r,a,n,s,i=t.note_time,o=Math.round(i*t.sample_rate),h=t.settings.window_length,u=t.settings.window_type,l=t.settings.window_alpha,f=t.settings.overlap,c=Math.round(h/f),p=Math.round(h/2),d=e,y=Math.ceil(d.length/o),g=t.settings.height,_=(t.settings.height-1,t.settings.minfreq),m=t.settings.maxfreq,b=[],v=new Uint8ClampedArray(y*g*4),w=t.sample_rate/h,S=Math.round(_/w),A=Math.round(m/w),P=p+S,I=p+S+A,M=0,E=255,T=o/d.length*100,F=0;for(o>2*h&&postMessage("Conversion failed, there is "+o+" samples to process for a window length (* 2) of "+2*h+", please use different settings."),_stereo&&(T/=2),STFT.initializeForwardWindow(h,u,l),r=STFT.forward(h,function(e,r){if(b.push({r:e,i:r}),b.length===f){var a,n,s,i,o,h,u,l,c,p,d,_,m,w,M=0,E=0,T=0,D=0,R=[],L=[];for(E=0;E<r.length;E+=1){for(a=0,n=0,T=0;T<f;T+=2)a+=b[T].i[E]+b[T+1].i[E],n+=b[T].r[E]+b[T+1].r[E];R[E]=n/f,L[E]=a/f}if(t.interpolation)for(E=P;E<I;E+=1)m=S+logScale(E-P,A),s=S+_logScale(E-P,A),i=s+1,u=L[s],c=L[i],l=R[s],p=R[i],D=m-s,o=u+D*(c-u),h=l+D*(p-l),w=Math.sqrt(h*h+o*o)/f,d=Math.round(255*w),_=Math.round(180*Math.atan2(d,h)/Math.PI)/f*255,M=Math.round((E-P)/A*g)*y*4+F,v[M]=d,v[M+1]=d,v[M+2]=d,v[M+3]=_;else for(E=P;E<I;E+=1)m=S+logScale(E-P,A),s=S+_logScale(E-P,A),o=L[s],h=R[s],w=Math.sqrt(h*h+o*o)/f,d=Math.round(255*w),_=Math.round(180*Math.atan2(d,h)/Math.PI)/f*255,M=Math.round((E-P)/A*g)*y*4+F,v[M]=d,v[M+1]=d,v[M+2]=d,v[M+3]=_;F+=4,b=[]}},c),s=0;s<d.length;s+=o)_prev_progress=parseInt(_progress,10),_progress+=T,r(d.subarray(s,s+o)),parseInt(_progress,10)!==_prev_progress&&parseInt(_progress,10)%5===0&&postMessage(_parseInt10(_progress,10));for(s=0;s<v.length;s+=4)a=v[s],M=a>M?a:M,E=a<E?a:E;for(n=255/(M-E),s=0;s<v.length;s+=4)v[s]-=E,v[s+1]-=E,v[s+2]-=E,v[s]*=n,v[s+1]*=n,v[s+2]*=n;return{width:y,height:g,data:v}},_mergeChannels=function(t,e){var r=0;for(r=0;r<t.length;r+=4)t[r+1]=e[r+1],t[r+2]=(t[r]+e[r+1])/2,t[r+3]=(t[r+3]+e[r+3])/2;return t};self.onmessage=function(t){"use strict";var e=t.data,r=new Float32Array(e.left),a=null,n=null,s=null,i={pbuffer:null,width:null,height:null};_progress=0,_stereo=null!==e.right,n=_convert(e,r),e.right?(a=new Float32Array(e.right),s=_convert(e,a),i.pbuffer=_mergeChannels(n.data,s.data).buffer):i.pbuffer=n.data.buffer,i.width=n.width,i.height=n.height,postMessage(i,[i.pbuffer])};