self.onmessage=function(a){"use strict";var e=new Uint8ClampedArray(a.data.buffer),t=a.data.img_width,i=a.data.img_height,f=0,r=0,g=0,s=0,d=0,h=0,m=0,n=0,o=0;for(r=0;r<i;r+=1)for(g=4*r*t,f=0;f<t;f+=1)s=g+4*f,d=s+1,h=s+2,m=s+3,n=(e[s]+e[d]+e[h])/3,o=0===n?0:n/255,o*=255,o>=1&&(n=255*n/e[m],o*=e[m]/255),e[m]=o;postMessage({img_width:t,img_height:i,data:e.buffer},[e.buffer])};